import{r as s,cw as F,j as e,b as H,C as S,F as p,S as k,E as K,o as R,I as $,a as v}from"./main-DWRmJItp.js";import{C as j}from"./index-CIC2lPJU.js";import{R as G}from"./RedoOutlined-BHUbUeEq.js";import"./index-BL5qaRD0.js";import"./Dropdown-CRhi--nO.js";const{Search:M}=$,z=({pathwayId:a,organisms:l})=>{const[c,i]=s.useState(""),[n,d]=s.useState([]),[m,o]=s.useState(!1),[u,E]=s.useState([]),h=s.useRef(null),[g,I]=s.useState({width:0,height:0}),w=async t=>{o(!0);const r=await v.get(`/kegg/kgml/${t}`);i(r.data.image),d(r.data.entries),o(!1)};s.useEffect(()=>{a&&l&&w(`${l}${a}`)},[a,l]);const f=h.current?h.current.width/g.width:1,b=h.current?h.current.height/g.height:1,L=(t,r)=>u.some(C=>t.split(",").map(x=>x.trim().toLowerCase()).includes(C.trim().toLowerCase())||r.split(" ").map(x=>x.trim().toLowerCase()).includes(C.trim().toLowerCase())),y=s.useMemo(()=>u.length==0?n:n.map(t=>L(t.label,t.name)?{isHighlight:!0,...t}:{...t}),[n,u]);return console.log(y.filter(t=>t.isHighlight)),e.jsx(j,{size:"small",extra:e.jsxs(e.Fragment,{children:[e.jsx(R,{title:"刷新",children:e.jsx(G,{onClick:()=>w(`${l}${a}`)})}),e.jsx(M,{placeholder:"输入要高亮的基因/化合物ID，用逗号分隔",style:{width:250,marginLeft:10},allowClear:!0,onSearch:t=>E(t.split(","))})]}),title:`${l}${a}`,loading:m,children:e.jsx("div",{style:{position:"relative",display:"inline-block"},children:c&&e.jsxs(e.Fragment,{children:[e.jsx("img",{ref:h,src:c,alt:"KEGG pathway",style:{maxWidth:"100%",height:"auto"},onLoad:t=>{const r=t.currentTarget;I({width:r.naturalWidth,height:r.naturalHeight})}}),e.jsx("svg",{width:g.width,height:g.height,style:{position:"absolute",top:0,left:0},children:y.map(t=>e.jsxs("a",{href:t.link,target:"_blank",children:[e.jsx("rect",{x:(t.x-t.width/2)*f,y:(t.y-t.height/2)*b,width:t.width*f,height:t.height*b,fill:t.isHighlight?"red":"transparent",stroke:t.isHighlight?"red":"green",strokeWidth:2,rx:4,ry:4,children:t.isHighlight&&e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"1s",repeatCount:"indefinite"})}),e.jsx("title",{children:t.label})]},t.id))})]})})})},D=()=>{const[a,l]=s.useState(),[c]=F(),[i,n]=s.useState(),d=(m,o)=>{console.log(m),console.log(o),n(o)};return e.jsx(e.Fragment,{children:e.jsxs(H,{children:[e.jsx(S,{lg:6,sm:6,xs:24,style:{paddingRight:"1rem"},children:e.jsx(j,{size:"small",children:e.jsxs(p,{form:c,onValuesChange:d,children:[e.jsx(p.Item,{name:"organisms",label:"organisms",rules:[{required:!0,message:"该字段不能为空!"}],tooltip:e.jsxs(e.Fragment,{children:["KEGG Organisms:",e.jsx("a",{target:"_blank",href:"https://www.genome.jp/kegg/tables/br08606.html",children:"br08606"})]}),children:e.jsx(k,{allowClear:!0,options:[{label:"hsa",value:"hsa"},{label:"mmu",value:"mmu"},{label:"rno",value:"rno"}]})}),e.jsx(p.Item,{rules:[{required:!0,message:"该字段不能为空!"}],name:"pathwayId",label:"Pathway Id",children:e.jsx(k,{allowClear:!0,options:[{label:"04144",value:"04144"},{label:"04927",value:"04927"}]})})]})})}),e.jsx(S,{lg:18,sm:18,xs:24,children:i!=null&&i.organisms&&(i!=null&&i.pathwayId)?e.jsx(z,{...i}):e.jsxs(j,{children:["   ",e.jsx(K,{})]})})]})})};export{D as default};
