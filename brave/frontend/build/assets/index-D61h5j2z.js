import{r as h,t as F,_ as H,c as k,F as C,j as e,M as N,f as b,I as A,B as d,P as B,a as x,e as M,o as O,R as V,C as E,n as S,E as I}from"./index-B_3LX8Sv.js";import{C as R,M as $}from"./index-BKM-36RV.js";import{c as T}from"./utils-D2B0dIuM.js";import{u as L,b as D,p as G}from"./index-DxbtQs0z.js";import{D as U}from"./index-DCyJhlMn.js";import{S as W,P as q}from"./index-T5bbXZ1z.js";import{T as J}from"./index-CnwY4WqK.js";import"./index-ufbsmYFx.js";import"./index-BWj5Fyk7.js";import"./Table-DPfHYlNE.js";import"./addEventListener-BOhPI-H5.js";var K={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908 640H804V488c0-4.4-3.6-8-8-8H548v-96h108c8.8 0 16-7.2 16-16V80c0-8.8-7.2-16-16-16H368c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h108v96H228c-4.4 0-8 3.6-8 8v152H116c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h288c8.8 0 16-7.2 16-16V656c0-8.8-7.2-16-16-16H292v-88h440v88H620c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h288c8.8 0 16-7.2 16-16V656c0-8.8-7.2-16-16-16zm-564 76v168H176V716h168zm84-408V140h168v168H428zm420 576H680V716h168v168z"}}]},name:"apartment",theme:"outlined"},Q=function(c,g){return h.createElement(F,H({},c,{ref:g,icon:K}))},X=h.forwardRef(Q);const Y=({visible:o,onClose:c,params:g})=>{if(!o)return null;const[i,u]=h.useState([]),l=async()=>{const j=(await x.get("/list-namespace")).data;u(j)},{messageApi:m}=k(),[p,r]=h.useState(),[t]=C.useForm(),w=async()=>{const s=await t.validateFields();p?await x.post("/save-or-update-namespace",{...s,namespace_id:p.namespace_id}):await x.post("/save-or-update-namespace",{...s}),l()},_=async s=>{try{await x.delete(`/delete-namespace-by-id/${s}`),l(),m.success("删除成功")}catch(j){m.error(j.response.data.message)}};return h.useEffect(()=>{l()},[]),e.jsxs(N,{title:"安装namespace",open:o,onCancel:c,children:[e.jsx(b,{children:e.jsxs(C,{form:t,onFinish:w,children:[e.jsx(C.Item,{name:"name",label:"名称",rules:[{required:!0,message:"名称不能为空"}],children:e.jsx(A,{})}),e.jsx(C.Item,{children:e.jsx(d,{type:"primary",htmlType:"submit",children:"Submit"})})]})}),i&&i.map(s=>e.jsxs("div",{style:{display:"flex",marginBottom:"0.5rem",justifyContent:"space-between"},children:[e.jsxs("div",{children:[s.name,"(",s.namespace_id,")"]}),e.jsx(d,{type:"primary",size:"small",onClick:()=>{r(s),t.setFieldsValue({name:s.name})},children:"更新"}),e.jsx(B,{title:"确定删除吗？",onConfirm:()=>{_(s.namespace_id)},children:e.jsx(d,{danger:!0,size:"small",children:"删除"})})]},s.namespace_id))]})},Z=({visible:o,onClose:c,params:g})=>{if(!o)return null;const{messageApi:i}=k(),[u,l]=h.useState([]),m=async()=>{const t=(await x.get("/list-namespace-file")).data;l(t)};h.useEffect(()=>{m()},[]);const p=async r=>{try{await x.post(`/import-namespace-component?namespace=${r}`),m(),i.success("安装成功")}catch(t){i.error(t.response.data.message)}};return e.jsx(N,{footer:null,title:"安装namespace",open:o,onCancel:c,children:u&&u.map(r=>e.jsxs(b,{style:{display:"flex",marginBottom:"0.5rem",justifyContent:"space-between"},children:[e.jsxs("div",{children:[r.name,"(",r.namespace_id,")"]}),e.jsx(B,{title:"确定安装吗？",onConfirm:()=>{p(r.namespace_id)},children:e.jsx(d,{size:"small",children:"安装"})})]},r.namespace_id))})},me=({params:o,map:c})=>{const{Search:g}=A,{component_type:i}=o,u=a=>(c&&(a=c(a)),a.tags&&(a.tags=JSON.parse(a.tags)),{id:a.id,component_id:a.component_id,name:a.name,category:a.category,img:a.img,tags:a.tags,order:a.order_index,path:`/component/${i}/${a.component_id}`,namespace:a.namespace,namespace_name:a.namespace_name}),{data:l,pageNumber:m,totalPage:p,loading:r,reload:t,pageSize:w,setPageNumber:_,search:s}=L({pageApi:G,params:o||{},map:u}),j=M(),{messageApi:ee}=k(),{modal:n,openModal:y,closeModal:v}=O();return e.jsxs("div",{style:{maxWidth:"1500px",margin:"1rem auto"},children:[e.jsxs(b,{justify:"flex-end",gap:"small",children:[e.jsx(d,{size:"small",color:"cyan",variant:"solid",onClick:()=>{y("modalA",{data:void 0,structure:{component_type:i}})},children:"创建组件"}),e.jsx(d,{size:"small",color:"cyan",variant:"solid",onClick:()=>{y("modalB")},children:"创建/更新namespace"}),e.jsx(d,{size:"small",color:"cyan",variant:"solid",onClick:()=>{y("modalC")},children:"安装namespace"}),e.jsx(d,{size:"small",color:"primary",variant:"solid",onClick:t,children:"刷新"})]}),e.jsx("div",{style:{marginBottom:"2rem"}}),e.jsx(g,{placeholder:"搜索组件",allowClear:!0,enterButton:!0,onSearch:a=>{s(a)},style:{marginBottom:"1rem",width:400}}),e.jsx(W,{spinning:r,children:Array.isArray(l)&&l.length!=0?e.jsx(V,{gutter:16,style:{position:"relative"},children:l.map((a,P)=>e.jsx(E,{lg:6,sm:4,xs:24,style:{marginBottom:"1rem",cursor:"pointer"},children:e.jsxs(R,{hoverable:!0,className:"custom-card",style:{height:"100%",border:"1px solid #f0f0f0",borderRadius:"12px",overflow:"hidden",transition:"all 0.3s ease"},bodyStyle:{padding:"12px 16px"},cover:e.jsx("div",{style:{height:"15rem"},children:e.jsx("img",{style:{height:"100%",width:"100%",objectFit:"cover"},alt:a.label,src:a.img})}),onClick:()=>j(`${a.path}`),children:[e.jsx($,{title:e.jsxs(e.Fragment,{children:[a.name,e.jsx(S,{title:a==null?void 0:a.namespace,children:e.jsxs("span",{style:{margin:"0",color:"rgba(0, 0, 0, 0.45)",fontSize:"0.5rem"},children:[" ",a==null?void 0:a.namespace_name]})})]}),description:a==null?void 0:a.description,style:{marginBottom:"1rem"}}),a.tags&&Array.isArray(a.tags)&&a.tags.map((f,z)=>e.jsx(S,{title:f,children:e.jsx(J,{style:{wordBreak:"break-word",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:100,display:"inline-block",cursor:"default"},color:T[z],children:f})},z)),e.jsx("div",{onClick:f=>{f.stopPropagation(),y("modalG",a)},style:{position:"absolute",right:10,bottom:10,fontSize:15,color:"rgba(0,0,0,0.45)",cursor:"pointer"},children:e.jsx(X,{})})]})},P))}):e.jsx(I,{})}),p!=0&&e.jsxs(b,{style:{marginTop:"1rem"},align:"center",children:["一共",p,"条数据  ",e.jsx(q,{current:m,pageSize:w,total:p,onChange:a=>_(a),showSizeChanger:!1})]}),e.jsx(D,{callback:t,visible:n.key=="modalA"&&n.visible,onClose:v,params:n.params}),e.jsx(Y,{visible:n.key=="modalB"&&n.visible,onClose:v,params:n.params}),e.jsx(Z,{visible:n.key=="modalC"&&n.visible,onClose:v,params:n.params}),e.jsx(U,{visible:n.key=="modalG"&&n.visible,onClose:v,callback:t,params:n.params})]})};export{me as default};
