const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./chat-BoLMPH_2.js","./index-CWx5cHtj.js","./index-DLoYsyAm.css","./index-BhpvB4Wv.js","./index-BgXoXwrY.js","./index-BAlUq73q.js","./index-BpSRaiQ3.js","./DeleteOutlined-GCbL2R9N.js","./RedoOutlined-Dowy_FkJ.js","./index-Cd94iWUf.js","./relation-B2EUch9A.js"])))=>i.map(i=>d[i]);
import{r as w,O as Y,R as h,a3 as Se,N as ze,H as F,aH as be,V as xe,aG as Ce,Z as we,a0 as $e,a5 as ye,aI as Oe,aS as Ee,j as N,t as Ie,aR as oe,aT as Me,S as je,I as Pe}from"./index-CWx5cHtj.js";import Re from"./graph-view-BOfZ0_K9.js";import{R as _e}from"./UpOutlined-BTHmEo5F.js";import"./zoom-BGsqVsDF.js";import"./rgb-BwIoVOhg.js";import"./index-BhpvB4Wv.js";import"./index-BgXoXwrY.js";import"./index-BAlUq73q.js";import"./index-Dlnhd9Is.js";import"./index-DNPu2izs.js";const Ne=w.forwardRef((e,n)=>{const{prefixCls:r,className:o,children:t,size:m,style:a={}}=e,f=Y(`${r}-panel`,{[`${r}-panel-hidden`]:m===0},o),c=m!==void 0;return h.createElement("div",{ref:n,className:f,style:Object.assign(Object.assign({},a),{flexBasis:c?m:"auto",flexGrow:c?0:1})},t)}),ke=()=>null;var Be=function(e,n){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&n.indexOf(o)<0&&(r[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var t=0,o=Object.getOwnPropertySymbols(e);t<o.length;t++)n.indexOf(o[t])<0&&Object.prototype.propertyIsEnumerable.call(e,o[t])&&(r[o[t]]=e[o[t]]);return r};function Le(e){if(e&&typeof e=="object")return e;const n=!!e;return{start:n,end:n}}function Ve(e){return w.useMemo(()=>Se(e).filter(w.isValidElement).map(r=>{const{props:o}=r,{collapsible:t}=o,m=Be(o,["collapsible"]);return Object.assign(Object.assign({},m),{collapsible:Le(t)})}),[e])}function Te(e,n,r){return w.useMemo(()=>{const o=[];for(let t=0;t<e.length-1;t+=1){const m=e[t],a=e[t+1],f=n[t],c=n[t+1],{resizable:p=!0,min:d,collapsible:j}=m,{resizable:O=!0,min:v,collapsible:s}=a,u=p&&O&&(f!==0||!d)&&(c!==0||!v),x=j.end&&f>0||s.start&&c===0&&f>0,i=s.start&&c>0||j.end&&f===0&&c>0;o[t]={resizable:u,startCollapsible:!!(r?i:x),endCollapsible:!!(r?x:i)}}return o},[n,e])}function Q(e){return Number(e.slice(0,-1))/100}function ne(e){return typeof e=="string"&&e.endsWith("%")}function He(e,n){const r=e.map(s=>s.size),o=e.length,t=n||0,m=s=>s*t,[a,f]=h.useState(()=>e.map(s=>s.defaultSize)),c=h.useMemo(()=>{var s;const u=[];for(let x=0;x<o;x+=1)u[x]=(s=r[x])!==null&&s!==void 0?s:a[x];return u},[o,a,r]),p=h.useMemo(()=>{let s=[],u=0;for(let i=0;i<o;i+=1){const S=c[i];if(ne(S))s[i]=Q(S);else if(S||S===0){const T=Number(S);Number.isNaN(T)||(s[i]=T/t)}else u+=1,s[i]=void 0}const x=s.reduce((i,S)=>i+(S||0),0);if(x>1||!u){const i=1/x;s=s.map(S=>S===void 0?0:S*i)}else{const i=(1-x)/u;s=s.map(S=>S===void 0?i:S)}return s},[c,t]),d=h.useMemo(()=>p.map(m),[p,t]),j=h.useMemo(()=>e.map(s=>ne(s.min)?Q(s.min):(s.min||0)/t),[e,t]),O=h.useMemo(()=>e.map(s=>ne(s.max)?Q(s.max):(s.max||t)/t),[e,t]);return[h.useMemo(()=>n?d:c,[d,n]),d,p,j,O,f]}function De(e,n,r,o,t,m){const a=e.map(l=>[l.min,l.max]),f=o||0,c=l=>l*f;function p(l,E){return typeof l=="string"?c(Q(l)):l??E}const[d,j]=w.useState([]),O=w.useRef([]),[v,s]=w.useState(null),u=()=>r.map(c);return[l=>{j(u()),s({index:l,confirmed:!1})},(l,E)=>{var $;let I=null;if((!v||!v.confirmed)&&E!==0){if(E>0)I=l,s({index:l,confirmed:!0});else for(let g=l;g>=0;g-=1)if(d[g]>0&&n[g].resizable){I=g,s({index:g,confirmed:!0});break}}const C=($=I??(v==null?void 0:v.index))!==null&&$!==void 0?$:l,z=ze(d),M=C+1,H=p(a[C][0],0),_=p(a[M][0],0),L=p(a[C][1],f),D=p(a[M][1],f);let y=E;return z[C]+y<H&&(y=H-z[C]),z[M]-y<_&&(y=z[M]-_),z[C]+y>L&&(y=L-z[C]),z[M]-y>D&&(y=z[M]-D),z[C]+=y,z[M]-=y,t(z),z},()=>{s(null)},(l,E)=>{const $=u(),I=m?E==="start"?"end":"start":E,C=I==="start"?l:l+1,z=I==="start"?l+1:l,M=$[C],H=$[z];if(M!==0&&H!==0)$[C]=0,$[z]+=M,O.current[l]=M;else{const _=M+H,L=p(a[C][0],0),D=p(a[C][1],f),y=p(a[z][0],0),g=p(a[z][1],f),P=Math.max(L,_-g),A=(Math.min(D,_-y)-P)/2,R=O.current[l],V=_-R;R&&R<=g&&R>=y&&V<=D&&V>=L?($[z]=R,$[C]=V):($[C]-=A,$[z]+=A)}return t($),$},v==null?void 0:v.index]}function se(e){return typeof e=="number"&&!Number.isNaN(e)?Math.round(e):0}const Xe=e=>{const{prefixCls:n,vertical:r,index:o,active:t,ariaNow:m,ariaMin:a,ariaMax:f,resizable:c,startCollapsible:p,endCollapsible:d,onOffsetStart:j,onOffsetUpdate:O,onOffsetEnd:v,onCollapse:s,lazy:u,containerSize:x}=e,i=`${n}-bar`,[S,T]=w.useState(null),[l,E]=w.useState(0),$=r?0:l,I=r?l:0,C=g=>{c&&g.currentTarget&&(T([g.pageX,g.pageY]),j(o))},z=g=>{if(c&&g.touches.length===1){const P=g.touches[0];T([P.pageX,P.pageY]),j(o)}},M=g=>{const P=x*m/100,X=P+g,A=Math.max(0,x*a/100),R=Math.min(x,x*f/100);return Math.max(A,Math.min(R,X))-P},H=F((g,P)=>{const X=M(r?P:g);E(X)}),_=F(()=>{O(o,$,I,!0),E(0)});h.useEffect(()=>{if(S){const g=R=>{const{pageX:V,pageY:U}=R,W=V-S[0],Z=U-S[1];u?H(W,Z):O(o,W,Z)},P=()=>{u?_():v(),T(null)},X=R=>{if(R.touches.length===1){const V=R.touches[0],U=V.pageX-S[0],W=V.pageY-S[1];u?H(U,W):O(o,U,W)}},A=()=>{u&&_(),T(null),v()};return window.addEventListener("touchmove",X),window.addEventListener("touchend",A),window.addEventListener("mousemove",g),window.addEventListener("mouseup",P),()=>{window.removeEventListener("mousemove",g),window.removeEventListener("mouseup",P),window.removeEventListener("touchmove",X),window.removeEventListener("touchend",A)}}},[S,u,r,o,x,m,a,f]);const L={[`--${i}-preview-offset`]:`${l}px`},D=r?_e:be,y=r?xe:Ce;return h.createElement("div",{className:i,role:"separator","aria-valuenow":se(m),"aria-valuemin":se(a),"aria-valuemax":se(f)},u&&h.createElement("div",{className:Y(`${i}-preview`,{[`${i}-preview-active`]:!!l}),style:L}),h.createElement("div",{className:Y(`${i}-dragger`,{[`${i}-dragger-disabled`]:!c,[`${i}-dragger-active`]:t}),onMouseDown:C,onTouchStart:z}),p&&h.createElement("div",{className:Y(`${i}-collapse-bar`,`${i}-collapse-bar-start`),onClick:()=>s(o,"start")},h.createElement(D,{className:Y(`${i}-collapse-icon`,`${i}-collapse-start`)})),d&&h.createElement("div",{className:Y(`${i}-collapse-bar`,`${i}-collapse-bar-end`),onClick:()=>s(o,"end")},h.createElement(y,{className:Y(`${i}-collapse-icon`,`${i}-collapse-end`)})))},Ae=e=>{const{componentCls:n}=e;return{[`&-rtl${n}-horizontal`]:{[`> ${n}-bar`]:{[`${n}-bar-collapse-previous`]:{insetInlineEnd:0,insetInlineStart:"unset"},[`${n}-bar-collapse-next`]:{insetInlineEnd:"unset",insetInlineStart:0}}},[`&-rtl${n}-vertical`]:{[`> ${n}-bar`]:{[`${n}-bar-collapse-previous`]:{insetInlineEnd:"50%",insetInlineStart:"unset"},[`${n}-bar-collapse-next`]:{insetInlineEnd:"50%",insetInlineStart:"unset"}}}}},K={position:"absolute",top:"50%",left:{_skip_check_:!0,value:"50%"},transform:"translate(-50%, -50%)"},Ye=e=>{const{componentCls:n,colorFill:r,splitBarDraggableSize:o,splitBarSize:t,splitTriggerSize:m,controlItemBgHover:a,controlItemBgActive:f,controlItemBgActiveHover:c,prefixCls:p}=e,d=`${n}-bar`,j=`${n}-mask`,O=`${n}-panel`,v=e.calc(m).div(2).equal(),s=`${p}-bar-preview-offset`,u={position:"absolute",background:e.colorPrimary,opacity:.2,pointerEvents:"none",transition:"none",zIndex:1,display:"none"};return{[n]:Object.assign(Object.assign(Object.assign({},$e(e)),{display:"flex",width:"100%",height:"100%",alignItems:"stretch",[`> ${d}`]:{flex:"none",position:"relative",userSelect:"none",[`${d}-dragger`]:Object.assign(Object.assign({},K),{zIndex:1,"&::before":Object.assign({content:'""',background:a},K),"&::after":Object.assign({content:'""',background:r},K),[`&:hover:not(${d}-dragger-active)`]:{"&::before":{background:f}},"&-active":{zIndex:2,"&::before":{background:c}},[`&-disabled${d}-dragger`]:{zIndex:0,"&, &:hover, &-active":{cursor:"default","&::before":{background:a}},"&::after":{display:"none"}}}),[`${d}-collapse-bar`]:Object.assign(Object.assign({},K),{zIndex:e.zIndexPopupBase,background:a,fontSize:e.fontSizeSM,borderRadius:e.borderRadiusXS,color:e.colorText,cursor:"pointer",opacity:0,display:"flex",alignItems:"center",justifyContent:"center","@media(hover:none)":{opacity:1},"&:hover":{background:f},"&:active":{background:c}}),"&:hover, &:active":{[`${d}-collapse-bar`]:{opacity:1}}},[j]:{position:"fixed",zIndex:e.zIndexPopupBase,inset:0,"&-horizontal":{cursor:"col-resize"},"&-vertical":{cursor:"row-resize"}},"&-horizontal":{flexDirection:"row",[`> ${d}`]:{width:0,[`${d}-preview`]:Object.assign(Object.assign({height:"100%",width:t},u),{[`&${d}-preview-active`]:{display:"block",transform:`translateX(var(--${s}))`}}),[`${d}-dragger`]:{cursor:"col-resize",height:"100%",width:m,"&::before":{height:"100%",width:t},"&::after":{height:o,width:t}},[`${d}-collapse-bar`]:{width:e.fontSizeSM,height:e.controlHeightSM,"&-start":{left:{_skip_check_:!0,value:"auto"},right:{_skip_check_:!0,value:v},transform:"translateY(-50%)"},"&-end":{left:{_skip_check_:!0,value:v},right:{_skip_check_:!0,value:"auto"},transform:"translateY(-50%)"}}}},"&-vertical":{flexDirection:"column",[`> ${d}`]:{height:0,[`${d}-preview`]:Object.assign(Object.assign({height:t,width:"100%"},u),{[`&${d}-preview-active`]:{display:"block",transform:`translateY(var(--${s}))`}}),[`${d}-dragger`]:{cursor:"row-resize",width:"100%",height:m,"&::before":{width:"100%",height:t},"&::after":{width:o,height:t}},[`${d}-collapse-bar`]:{height:e.fontSizeSM,width:e.controlHeightSM,"&-start":{top:"auto",bottom:v,transform:"translateX(-50%)"},"&-end":{top:v,bottom:"auto",transform:"translateX(-50%)"}}}},[O]:{overflow:"auto",padding:"0 1px",scrollbarWidth:"thin",boxSizing:"border-box","&-hidden":{padding:0,overflow:"hidden"},[`&:has(${n}:only-child)`]:{overflow:"hidden"}}}),Ae(e))}},Ue=e=>{var n;const r=e.splitBarSize||2,o=e.splitTriggerSize||6,t=e.resizeSpinnerSize||20,m=(n=e.splitBarDraggableSize)!==null&&n!==void 0?n:t;return{splitBarSize:r,splitTriggerSize:o,splitBarDraggableSize:m,resizeSpinnerSize:t}},Ge=we("Splitter",e=>[Ye(e)],Ue),We=e=>{const{prefixCls:n,className:r,style:o,layout:t="horizontal",children:m,rootClassName:a,onResizeStart:f,onResize:c,onResizeEnd:p,lazy:d}=e,{getPrefixCls:j,direction:O,className:v,style:s}=ye("splitter"),u=j("splitter",n),x=Oe(u),[i,S,T]=Ge(u,x),l=t==="vertical",E=O==="rtl",$=!l&&E,I=Ve(m),[C,z]=w.useState(),M=k=>{const{offsetWidth:b,offsetHeight:B}=k,G=l?B:b;G!==0&&z(G)},[H,_,L,D,y,g]=He(I,C),P=Te(I,_,E),[X,A,R,V,U]=De(I,P,L,C,g,E),W=F(k=>{X(k),f==null||f(_)}),Z=F((k,b,B)=>{const G=A(k,b);B?p==null||p(G):c==null||c(G)}),ae=F(()=>{R(),p==null||p(_)}),ie=F((k,b)=>{const B=V(k,b);c==null||c(B),p==null||p(B)}),le=Y(u,r,`${u}-${t}`,{[`${u}-rtl`]:E},a,v,T,x,S),re=`${u}-mask`,q=h.useMemo(()=>{const k=[];let b=0;for(let B=0;B<I.length;B+=1)b+=L[B],k.push(b);return k},[L]),ce=Object.assign(Object.assign({},s),o);return i(h.createElement(Ee,{onResize:M},h.createElement("div",{style:ce,className:le},I.map((k,b)=>{const B=h.createElement(Ne,Object.assign({},k,{prefixCls:u,size:H[b]}));let G=null;const J=P[b];if(J){const de=(q[b-1]||0)+D[b],ue=(q[b+1]||100)-y[b+1],pe=(q[b-1]||0)+y[b],fe=(q[b+1]||100)-D[b+1];G=h.createElement(Xe,{lazy:d,index:b,active:U===b,prefixCls:u,vertical:l,resizable:J.resizable,ariaNow:q[b]*100,ariaMin:Math.max(de,ue)*100,ariaMax:Math.min(pe,fe)*100,startCollapsible:J.startCollapsible,endCollapsible:J.endCollapsible,onOffsetStart:W,onOffsetUpdate:(me,ge,he,ve)=>{let te=l?he:ge;$&&(te=-te),Z(me,te,ve)},onOffsetEnd:ae,onCollapse:ie,containerSize:C||0})}return h.createElement(h.Fragment,{key:`split-panel-${b}`},B,G)}),typeof U=="number"&&h.createElement("div",{"aria-hidden":!0,className:Y(re,`${re}-${t}`)}))))},ee=We;ee.Panel=ke;const Fe=w.lazy(()=>oe(()=>import("./chat-BoLMPH_2.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url)),qe=w.lazy(()=>oe(()=>import("./index-BpSRaiQ3.js"),__vite__mapDeps([6,1,2,3,4,5,7,8,9]),import.meta.url)),Ze=w.lazy(()=>oe(()=>import("./relation-B2EUch9A.js"),__vite__mapDeps([10,1,2,3,4,5,7,8]),import.meta.url)),Je=[{key:"chat",label:"聊天窗口",component:Fe},{key:"details",label:"详情",component:qe},{key:"relation",label:"关系",component:Ze}],Ke=({graphOpt:e,height:n,data:r,view:o,close:t})=>{if(!o)return N.jsx("div",{onClick:t,children:"未知类型"});const m=Je.find(p=>p.key===o);if(!m)return N.jsx("div",{children:"未知类型"});const{component:a,key:f,...c}=m;return N.jsx(w.Suspense,{fallback:N.jsx(Ie,{active:!0}),children:N.jsx(a,{close:t,data:r,...c,height:n,graphOpt:e})})},{Option:ct}=je,{Search:dt}=Pe,ut=()=>{const[e,n]=h.useState(["100%","0%"]),[r,o]=w.useState(null),[t,m]=w.useState(),a=w.useRef(null),f=w.useRef(null),[c,p]=w.useState(null),d=()=>{if(f.current){const s=f.current.getBoundingClientRect().top;p(window.innerHeight-s)}},j=()=>{a.current&&a.current.reload()},O=()=>{a.current&&a.current.cancelSelectLink()},v=()=>{a.current&&a.current.cancelSelectNode()};return w.useEffect(()=>(d(),window.addEventListener("resize",d),()=>{window.removeEventListener("resize",d)}),[]),N.jsx("div",{style:{backgroundColor:"#f0f2f5",padding:"1rem 1rem 0 1rem  "},children:N.jsx("div",{ref:f,children:N.jsx(Me,{theme:{components:{Splitter:{splitBarSize:5,splitTriggerSize:30}}},children:N.jsxs(ee,{onResize:n,children:[N.jsx(ee.Panel,{size:e[0],min:"20%",style:{paddingRight:`${r?"0.5rem":"0"}`},children:N.jsx(Re,{ref:a,height:c,openView:(s,u)=>{o(s),n(["70%","30%"]),u&&m(u)},activeView:r})}),r&&N.jsx(ee.Panel,{size:e[1],min:"20%",style:{paddingLeft:`${r?"0.5rem":"0"}`},children:N.jsx(Ke,{graphOpt:{loadGraph:j,cancelSelectLink:O,cancelSelectNode:v},height:c,data:t,view:r,close:()=>{o(null),m(null),n(["100%","0%"]),O(),v()}})})]})})})})};export{ut as default};
