import{r as a,d as g,f as y,j as e,b as S,C as u,E as f,g as C,B as R,a as A,V as E}from"./main-gLSsR9RJ.js";import{d as F}from"./index-CGugvcta.js";import{C as j}from"./index-C0N-NGLH.js";import{T as w}from"./Table-CR7g3HiW.js";import"./index-MIG_kUMZ.js";import"./index-i78tPWpu.js";import"./addEventListener-CTJtiein.js";import"./index-DoeMV2fv.js";import"./index-Cz_1T5Rx.js";import"./UpOutlined-hpn1VrTh.js";import"./index-C11mV772.js";import"./index-CZkDjHh0.js";import"./Dropdown-_lWu8YLp.js";import"./index-BKkflL4l.js";import"./callSuper-kYkVM6ly.js";import"./index-CaXusF4h.js";import"./Pagination-C_9v4VMr.js";const J=()=>{const[m,i]=a.useState(!1),{project:c,projectObj:r}=g(),[n,p]=a.useState(),[t,d]=a.useState();a.useRef(null),y();const x=async()=>{var o,l,h;i(!0);let s=await A.post("/list-analysis-tree",{is_report:!0,project:c});p(s.data),s.data.length>0&&(o=s.data[0])!=null&&o.children&&((l=s.data[0])==null?void 0:l.children.length)>0&&d((h=s.data[0])==null?void 0:h.children[0]),i(!1)};return a.useEffect(()=>{x()},[c]),e.jsx("div",{style:{maxWidth:"1500px",margin:"0 auto"},children:e.jsxs(S,{children:[e.jsx(u,{lg:6,sm:6,xs:24,children:e.jsx(j,{loading:m,title:r==null?void 0:r.project_name,size:"small",extra:e.jsx(C,{gap:"small",children:e.jsx(R,{size:"small",color:"cyan",variant:"solid",onClick:x,children:"刷新"})}),children:Array.isArray(n)&&n.length!=0?e.jsx(e.Fragment,{children:e.jsx(k,{onSelect:s=>{var o,l;((o=s.node)==null?void 0:o.type)=="analysis"?d(s.node):((l=s.node)==null?void 0:l.type)=="components"&&console.log(s.node)},defaultSelectKey:t==null?void 0:t.key,treeData:n})}):e.jsx(e.Fragment,{children:e.jsx(f,{})})})}),e.jsx(u,{lg:18,sm:18,xs:24,style:{paddingLeft:"1rem"},children:t?e.jsx(e.Fragment,{children:e.jsx(F,{cancalReportCallback:()=>{x()},analysis_id:t==null?void 0:t.key})}):e.jsx(e.Fragment,{children:e.jsx(j,{size:"small",children:e.jsx(f,{})})})})]})})},k=({treeData:m,defaultSelectKey:i,onSelect:c})=>{const[r,n]=a.useState(i),p=(t,d)=>{t.length>0&&(c(d),n(t[0]))};return e.jsx(e.Fragment,{children:e.jsx(w,{selectedKeys:[r],showLine:!0,switcherIcon:e.jsx(E,{}),defaultExpandAll:!0,onSelect:p,treeData:m})})};export{J as default};
