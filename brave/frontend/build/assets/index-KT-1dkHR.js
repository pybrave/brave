import{r as p,v as H,_ as R,e as _,F as z,j as e,M as P,g as j,I as B,B as i,P as F,a as g,h as O,u as $,p as M,c as V,C as E,o as A,E as L}from"./main-DXb8rb93.js";import{C as T,M as U}from"./index-CTlwZfJX.js";import{c as D}from"./utils-D2B0dIuM.js";import{b as G,p as W}from"./index-BYUokkww.js";import{u as q}from"./usePagination-gn6S2hbC.js";import{R as J}from"./PlusCircleOutlined-CRNzBXNP.js";import{D as K}from"./index-OkuWydCf.js";import{S as Q,P as X}from"./index-BaWKjIxw.js";import{T as Y}from"./index-D6j9es1G.js";import"./index-Cc4yTCQW.js";import"./Dropdown-ClNMeq8P.js";import"./index-C54HiVZI.js";import"./UpOutlined-D94vvVUq.js";import"./index-DIQD0cKY.js";import"./DeleteOutlined-Ba-2K4N2.js";import"./Table-Dop9r612.js";import"./addEventListener-BOvmtz4c.js";var Z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908 640H804V488c0-4.4-3.6-8-8-8H548v-96h108c8.8 0 16-7.2 16-16V80c0-8.8-7.2-16-16-16H368c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h108v96H228c-4.4 0-8 3.6-8 8v152H116c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h288c8.8 0 16-7.2 16-16V656c0-8.8-7.2-16-16-16H292v-88h440v88H620c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h288c8.8 0 16-7.2 16-16V656c0-8.8-7.2-16-16-16zm-564 76v168H176V716h168zm84-408V140h168v168H428zm420 576H680V716h168v168z"}}]},name:"apartment",theme:"outlined"},ee=function(c,y){return p.createElement(H,R({},c,{ref:y,icon:Z}))},ae=p.forwardRef(ee);const se=({visible:t,onClose:c,params:y})=>{if(!t)return null;const[m,d]=p.useState([]),h=async()=>{const v=(await g.get("/list-namespace")).data;d(v)},{messageApi:o}=_(),[u,n]=p.useState(),[l]=z.useForm(),[f,x]=p.useState(!1),S=async()=>{const s=await l.validateFields();u?await g.post("/save-or-update-namespace",{...s,namespace_id:u.namespace_id}):await g.post("/save-or-update-namespace",{...s}),x(!1),h()},k=async s=>{try{await g.delete(`/delete-namespace-by-id/${s}`),h(),o.success("删除成功")}catch(v){o.error(v.response.data.message)}};return p.useEffect(()=>{h()},[]),e.jsx(P,{title:e.jsxs(j,{gap:"small",children:["Install namespace",e.jsx(J,{style:{cursor:"pointer",color:"cyan"},onClick:()=>{x(!0)}})]}),open:t,onCancel:c,footer:null,children:f?e.jsx(e.Fragment,{children:e.jsx(j,{children:e.jsxs(z,{form:l,onFinish:S,children:[e.jsx(z.Item,{name:"name",label:"Name",rules:[{required:!0,message:"名称不能为空"}],children:e.jsx(B,{})}),e.jsxs(z.Item,{children:[e.jsx(i,{size:"small",color:"cyan",variant:"solid",htmlType:"submit",children:"Submit"}),e.jsx(i,{style:{marginLeft:"1rem"},size:"small",color:"cyan",variant:"solid",onClick:()=>{x(!1)},children:"Cancel"})]})]})})}):e.jsx(e.Fragment,{children:m&&m.map(s=>e.jsxs("div",{style:{display:"flex",marginBottom:"0.5rem",justifyContent:"space-between"},children:[e.jsxs("div",{children:[s.name,"(",s.namespace_id,")"]}),e.jsx(i,{size:"small",color:"cyan",variant:"solid",onClick:()=>{x(!0),n(s),l.setFieldsValue({name:s.name})},children:"更新"}),e.jsx(F,{title:"确定删除吗？",onConfirm:()=>{k(s.namespace_id)},children:e.jsx(i,{danger:!0,size:"small",variant:"solid",children:"删除"})})]},s.namespace_id))})})},ne=({visible:t,onClose:c,params:y})=>{if(!t)return null;const{messageApi:m}=_(),[d,h]=p.useState([]),o=async()=>{const l=(await g.get("/list-namespace-file")).data;h(l)};p.useEffect(()=>{o()},[]);const u=async n=>{try{await g.post(`/import-namespace-component?namespace=${n}`),o(),m.success("安装成功")}catch(l){m.error(l.response.data.message)}};return e.jsx(P,{footer:null,title:"Install namespace",open:t,onCancel:c,children:d&&d.map(n=>e.jsxs(j,{style:{display:"flex",marginBottom:"0.5rem",justifyContent:"space-between"},children:[e.jsxs("div",{children:[n.name,"(",n.namespace_id,")"]}),e.jsx(F,{title:"Are you sure to install it?",onConfirm:()=>{u(n.namespace_id)},children:e.jsx(i,{size:"small",color:"cyan",variant:"solid",children:"Install"})})]},n.namespace_id))})},Ce=({params:t,map:c})=>{const{Search:y}=B,{baseURL:m}=O(a=>a.user),{component_type:d}=t,h=a=>(c&&(a=c(a)),a.tags&&(a.tags=JSON.parse(a.tags)),{id:a.id,component_id:a.component_id,name:a.name,category:a.category,img:a.img,tags:a.tags,order:a.order_index,path:`/component/${d}/${a.component_id}`,namespace:a.namespace,namespace_name:a.namespace_name}),{data:o,pageNumber:u,totalPage:n,loading:l,reload:f,pageSize:x,setPageNumber:S,search:k}=q({pageApi:W,params:t||{},map:h,initialPageSize:12}),s=$(),{messageApi:v}=_(),{modal:r,openModal:C,closeModal:b}=M();return e.jsxs("div",{style:{maxWidth:"1500px",margin:"1rem auto"},children:[e.jsxs(j,{justify:"space-between",gap:"small",children:[e.jsx(y,{size:"small",placeholder:"Search Components",allowClear:!0,enterButton:!0,onSearch:a=>{k(a)},style:{marginBottom:"1rem",width:400}}),e.jsxs(j,{gap:"small",children:[e.jsx(i,{size:"small",color:"cyan",variant:"solid",onClick:()=>{C("modalA",{data:void 0,structure:{component_type:d}})},children:"Creating Components "}),e.jsx(i,{size:"small",color:"cyan",variant:"solid",onClick:()=>{C("modalB")},children:"Create/Update  namespace"}),e.jsx(i,{size:"small",color:"cyan",variant:"solid",onClick:()=>{C("modalC")},children:"Install namespace"}),e.jsx(i,{size:"small",color:"primary",variant:"solid",onClick:f,children:"Refresh"})]})]}),e.jsx(Q,{spinning:l,children:Array.isArray(o)&&o.length!=0?e.jsx(V,{gutter:16,style:{position:"relative"},children:o.map((a,I)=>e.jsx(E,{lg:6,sm:4,xs:24,style:{marginBottom:"1rem",cursor:"pointer"},children:e.jsxs(T,{hoverable:!0,className:"custom-card",style:{height:"100%",border:"1px solid #f0f0f0",borderRadius:"12px",overflow:"hidden",transition:"all 0.3s ease"},bodyStyle:{padding:"12px 16px"},cover:e.jsx("div",{style:{height:"15rem"},children:e.jsx("img",{style:{height:"100%",width:"100%",objectFit:"cover"},alt:a.label,src:`${m}${a.img}`})}),onClick:()=>s(`${a.path}`),children:[e.jsx(U,{title:e.jsxs(e.Fragment,{children:[a.name,e.jsx(A,{title:a==null?void 0:a.namespace,children:e.jsxs("span",{style:{margin:"0",color:"rgba(0, 0, 0, 0.45)",fontSize:"0.5rem"},children:[" ",a==null?void 0:a.namespace_name]})})]}),description:a==null?void 0:a.description,style:{marginBottom:"1rem"}}),a.tags&&Array.isArray(a.tags)&&a.tags.map((w,N)=>e.jsx(A,{title:w,children:e.jsx(Y,{style:{wordBreak:"break-word",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:100,display:"inline-block",cursor:"default"},color:D[N],children:w})},N)),e.jsx("div",{onClick:w=>{w.stopPropagation(),C("modalG",a)},style:{position:"absolute",right:10,bottom:10,fontSize:15,color:"rgba(0,0,0,0.45)",cursor:"pointer"},children:e.jsx(ae,{})})]})},I))}):e.jsx(L,{})}),n!=0&&e.jsxs(j,{style:{marginTop:"1rem"},align:"center",children:["一共",n,"条数据  ",e.jsx(X,{current:u,pageSize:x,total:n,onChange:a=>S(a),showSizeChanger:!1})]}),e.jsx(G,{callback:f,visible:r.key=="modalA"&&r.visible,onClose:b,params:r.params}),e.jsx(se,{visible:r.key=="modalB"&&r.visible,onClose:b,params:r.params}),e.jsx(ne,{visible:r.key=="modalC"&&r.visible,onClose:b,params:r.params}),e.jsx(K,{visible:r.key=="modalG"&&r.visible,onClose:b,callback:f,params:r.params})]})};export{Ce as default};
