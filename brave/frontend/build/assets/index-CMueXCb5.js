import{r,Q as w,U as P,L as M,V as A,W as O,P as $,X as B,j as e,Y as R,B as u,Z as m,a as g,t as S,C as z,v as E,$ as H,a0 as D,a1 as _,a2 as W,a3 as T,a4 as U,a5 as F,a6 as L}from"./index-BaBKrGkd.js";var N={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"},Q=function(l,c){return r.createElement(w,P({},l,{ref:c,icon:N}))},V=r.forwardRef(Q);const J=()=>{const{project:v}=M(),[l,c]=r.useState([]),[X,Y]=r.useState(!1),[Z,q]=r.useState(),y=A(),j=O(),[p,f]=$.useMessage(),{modal:d,openModal:x,closeModal:C}=B(),n=async()=>{const t=await L(j);console.log(t);const o=t.map(s=>({name:s.name,items:s.items.map(h=>{const{path:a,name:i,...k}=h;return{key:`pipeline/${a}`,label:i,...k}})}));c(o)},b=async t=>{try{const o=await g.delete(`/delete-pipeline/${t}`);p.success("删除成功!"),n()}catch(o){console.log(o),p.error(`删除失败!${o.response.data.detail}`)}};return r.useEffect(()=>{n()},[]),e.jsxs("div",{style:{maxWidth:"1500px",margin:"1rem auto"},children:[f,e.jsxs(R,{justify:"flex-end",gap:"small",children:[e.jsx(u,{color:"cyan",variant:"solid",onClick:()=>{x("modalA",{data:void 0,structure:{component_type:"pipeline"}})},children:"创建流程"}),e.jsx(m,{title:"是否安装?",onConfirm:async()=>{await g.post("/import-pipeline"),p.success("安装成功!"),n()},children:e.jsx(u,{color:"cyan",variant:"solid",children:"从本地安装"})}),e.jsx(u,{color:"primary",variant:"solid",onClick:n,children:"刷新"})]}),Array.isArray(l)&&l.length!=0?l.map((t,o)=>e.jsxs("div",{children:[e.jsx("h2",{children:t.name}),e.jsx("hr",{}),e.jsx(S,{gutter:16,style:{position:"relative"},children:t==null?void 0:t.items.map((s,h)=>e.jsx(z,{lg:4,sm:6,xs:24,style:{marginBottom:"1rem",cursor:"pointer"},children:e.jsxs(E,{hoverable:!0,style:{height:"100%"},cover:e.jsx("img",{alt:s.label,src:s.img}),onClick:()=>y(`/${s.key}`),children:[e.jsx(H,{title:s.label,description:s==null?void 0:s.description,style:{marginBottom:"1rem"}}),s.tags&&Array.isArray(s.tags)&&s.tags.map((a,i)=>e.jsx(D,{title:a,children:e.jsx(_,{style:{wordBreak:"break-word",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:100,display:"inline-block",cursor:"default"},color:W[i],children:a})},i)),e.jsx(T,{onClick:a=>{a.stopPropagation(),x("modalA",{data:s,structure:{component_type:"pipeline"}})},style:{position:"absolute",right:40,bottom:10,fontSize:15,color:"rgba(0,0,0,0.45)",cursor:"pointer"}}),e.jsx(m,{title:"是否删除?",onConfirm:a=>{a.stopPropagation(),b(s.pipeline_id)},onCancel:a=>{a.stopPropagation()},children:e.jsx(V,{onClick:a=>a.stopPropagation(),style:{position:"absolute",right:10,bottom:10,fontSize:15,color:"rgba(0,0,0,0.45)",cursor:"pointer"}})})]})},h))})]},o)):e.jsx(U,{}),e.jsx(F,{callback:n,visible:d.key=="modalA"&&d.visible,onClose:C,params:d.params}),!1]})};export{J as default};
