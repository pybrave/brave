import{r as n,ah as P,ai as O,a as g,aj as M,z as S,ak as z,al as B,ag as R,j as e,am as _,B as x,an as j,t as $,C as A,v as E,ao as H,ap as D,aq as T,ar as W,as as q,at as F,au as N}from"./index-DS9Fhaew.js";var G={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"},J=function(o,p){return n.createElement(P,O({},o,{ref:p,icon:G}))},K=n.forwardRef(J);const L=async c=>{const o=await g.get("/list-pipeline-v2");return c(M(o.data)),o.data},U=()=>{const{project:c}=S(),[o,p]=n.useState([]),[y,d]=n.useState(!1),[f,v]=n.useState(),m=z(),C=B(),[h,b]=R.useMessage(),i=async()=>{const t=await L(C);console.log(t);const r=t.map(a=>({name:a.name,items:a.items.map(u=>{const{path:s,name:l,...k}=u;return{key:`pipeline/${s}`,label:l,...k}})}));p(r)},w=async t=>{try{const r=await g.delete(`/delete-pipeline/${t}`);h.success("删除成功!"),i()}catch(r){console.log(r),h.error(`删除失败!${r.response.data.detail}`)}};return n.useEffect(()=>{i()},[]),e.jsxs("div",{style:{maxWidth:"1500px",margin:"1rem auto"},children:[b,e.jsxs(_,{justify:"flex-end",gap:"small",children:[e.jsx(x,{color:"cyan",variant:"solid",onClick:()=>{v(void 0),d(!0)},children:"创建流程"}),e.jsx(j,{title:"是否安装?",onConfirm:async()=>{await g.post("/import-pipeline"),h.success("安装成功!"),i()},children:e.jsx(x,{color:"cyan",variant:"solid",children:"从本地安装"})}),e.jsx(x,{color:"primary",variant:"solid",onClick:i,children:"刷新"})]}),Array.isArray(o)&&o.length!=0?o.map((t,r)=>e.jsxs("div",{children:[e.jsx("h2",{children:t.name}),e.jsx("hr",{}),e.jsx($,{gutter:16,style:{position:"relative"},children:t==null?void 0:t.items.map((a,u)=>e.jsx(A,{lg:4,sm:6,xs:24,style:{marginBottom:"1rem",cursor:"pointer"},children:e.jsxs(E,{hoverable:!0,style:{height:"100%"},cover:e.jsx("img",{alt:a.label,src:a.img}),onClick:()=>m(`/${a.key}`),children:[e.jsx(H,{title:a.label,description:a==null?void 0:a.description,style:{marginBottom:"1rem"}}),a.tags&&Array.isArray(a.tags)&&a.tags.map((s,l)=>e.jsx(D,{title:s,children:e.jsx(T,{style:{wordBreak:"break-word",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:100,display:"inline-block",cursor:"default"},color:W[l],children:s})},l)),e.jsx(q,{onClick:s=>{s.stopPropagation(),d(!0),console.log(a),v(a)},style:{position:"absolute",right:40,bottom:10,fontSize:15,color:"rgba(0,0,0,0.45)",cursor:"pointer"}}),e.jsx(j,{title:"是否删除?",onConfirm:s=>{s.stopPropagation(),w(a.pipeline_id)},onCancel:s=>{s.stopPropagation()},children:e.jsx(K,{onClick:s=>s.stopPropagation(),style:{position:"absolute",right:10,bottom:10,fontSize:15,color:"rgba(0,0,0,0.45)",cursor:"pointer"}})})]})},u))})]},r)):e.jsx(F,{}),e.jsx(N,{callback:i,pipelineStructure:{pipeline_type:"wrap_pipeline",parent_pipeline_id:"0"},open:y,setOpen:d,data:f}),!1]})};export{U as default};
