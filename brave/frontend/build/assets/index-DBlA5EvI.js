const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./graph-view-BxwqRE5_.js","./main-Bw4HDwdl.js","./main-DLoYsyAm.css","./index-B-qvGi8z.js","./index-ClFmFDqn.js","./Dropdown-bzLw1xrE.js","./index-AJ8DPt0q.js","./index-Edtf3g26.js","./Table-Nj5nWv8r.js","./addEventListener-DD_5BdRR.js","./NodeIndexOutlined-DFywQg7_.js","./index-DCK1FHNl.js","./usePagination-BdZ1KYmS.js","./index-Ch4DwbeY.js"])))=>i.map(i=>d[i]);
import{r as s,v as me,_ as Z,ad as B,aN as ze,aj as Te,ac as Q,O as J,ak as ge,ag as He,ax as Ae,aO as ke,ae as q,aw as ye,Z as Ve,$ as Le,a0 as Be,a2 as Ke,a1 as k,aP as Ue,aC as We,aQ as qe,a5 as Ge,a6 as Xe,j as a,o as N,aR as Je,f as Ye,d as fe,B as X,P as re,a as U,g as Y,S as V,I as K,aq as Ze,F as R,q as ve,M as be,i as Qe,c as et,t as xe,aL as tt}from"./main-Bw4HDwdl.js";import{T as oe}from"./index-Edtf3g26.js";import{u as at}from"./usePagination-BdZ1KYmS.js";import{S as nt,F as it,T as _e}from"./Table-Nj5nWv8r.js";import{P as st,S as lt}from"./index-AJ8DPt0q.js";import{S as je}from"./index-Ch4DwbeY.js";import{T as rt}from"./index-ClFmFDqn.js";import{D as pe}from"./index-DCK1FHNl.js";var ot={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"},dt=function(e,i){return s.createElement(me,Z({},e,{ref:i,icon:ot}))},ct=s.forwardRef(dt),ut={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"}}]},name:"redo",theme:"outlined"},ht=function(e,i){return s.createElement(me,Z({},e,{ref:i,icon:ut}))},mt=s.forwardRef(ht),de=function(e,i){if(!e)return null;var n={left:e.offsetLeft,right:e.parentElement.clientWidth-e.clientWidth-e.offsetLeft,width:e.clientWidth,top:e.offsetTop,bottom:e.parentElement.clientHeight-e.clientHeight-e.offsetTop,height:e.clientHeight};return i?{left:0,right:0,width:0,top:n.top,bottom:n.bottom,height:n.height}:{left:n.left,right:n.right,width:n.width,top:0,bottom:0,height:0}},z=function(e){return e!==void 0?"".concat(e,"px"):void 0};function gt(t){var e=t.prefixCls,i=t.containerRef,n=t.value,l=t.getValueIndex,r=t.motionName,h=t.onMotionStart,f=t.onMotionEnd,v=t.direction,y=t.vertical,m=y===void 0?!1:y,_=s.useRef(null),g=s.useState(n),w=B(g,2),p=w[0],C=w[1],O=function(A){var T,L=l(A),H=(T=i.current)===null||T===void 0?void 0:T.querySelectorAll(".".concat(e,"-item"))[L];return(H==null?void 0:H.offsetParent)&&H},M=s.useState(null),d=B(M,2),o=d[0],j=d[1],E=s.useState(null),x=B(E,2),u=x[0],$=x[1];ze(function(){if(p!==n){var I=O(p),A=O(n),T=de(I,m),L=de(A,m);C(n),j(T),$(L),I&&A?h():f()}},[n]);var b=s.useMemo(function(){if(m){var I;return z((I=o==null?void 0:o.top)!==null&&I!==void 0?I:0)}return z(v==="rtl"?-(o==null?void 0:o.right):o==null?void 0:o.left)},[m,v,o]),c=s.useMemo(function(){if(m){var I;return z((I=u==null?void 0:u.top)!==null&&I!==void 0?I:0)}return z(v==="rtl"?-(u==null?void 0:u.right):u==null?void 0:u.left)},[m,v,u]),F=function(){return m?{transform:"translateY(var(--thumb-start-top))",height:"var(--thumb-start-height)"}:{transform:"translateX(var(--thumb-start-left))",width:"var(--thumb-start-width)"}},S=function(){return m?{transform:"translateY(var(--thumb-active-top))",height:"var(--thumb-active-height)"}:{transform:"translateX(var(--thumb-active-left))",width:"var(--thumb-active-width)"}},G=function(){j(null),$(null),f()};return!o||!u?null:s.createElement(Te,{visible:!0,motionName:r,motionAppear:!0,onAppearStart:F,onAppearActive:S,onVisibleChanged:G},function(I,A){var T=I.className,L=I.style,H=Q(Q({},L),{},{"--thumb-start-left":b,"--thumb-start-width":z(o==null?void 0:o.width),"--thumb-active-left":c,"--thumb-active-width":z(u==null?void 0:u.width),"--thumb-start-top":b,"--thumb-start-height":z(o==null?void 0:o.height),"--thumb-active-top":c,"--thumb-active-height":z(u==null?void 0:u.height)}),ee={ref:ge(_,A),style:H,className:J("".concat(e,"-thumb"),T)};return s.createElement("div",ee)})}var yt=["prefixCls","direction","vertical","options","disabled","defaultValue","value","name","onChange","className","motionName"];function ft(t){if(typeof t.title<"u")return t.title;if(ye(t.label)!=="object"){var e;return(e=t.label)===null||e===void 0?void 0:e.toString()}}function vt(t){return t.map(function(e){if(ye(e)==="object"&&e!==null){var i=ft(e);return Q(Q({},e),{},{title:i})}return{label:e==null?void 0:e.toString(),title:e==null?void 0:e.toString(),value:e}})}var bt=function(e){var i=e.prefixCls,n=e.className,l=e.disabled,r=e.checked,h=e.label,f=e.title,v=e.value,y=e.name,m=e.onChange,_=e.onFocus,g=e.onBlur,w=e.onKeyDown,p=e.onKeyUp,C=e.onMouseDown,O=function(d){l||m(d,v)};return s.createElement("label",{className:J(n,q({},"".concat(i,"-item-disabled"),l)),onMouseDown:C},s.createElement("input",{name:y,className:"".concat(i,"-item-input"),type:"radio",disabled:l,checked:r,onChange:O,onFocus:_,onBlur:g,onKeyDown:w,onKeyUp:p}),s.createElement("div",{className:"".concat(i,"-item-label"),title:f,"aria-selected":r},h))},xt=s.forwardRef(function(t,e){var i,n,l=t.prefixCls,r=l===void 0?"rc-segmented":l,h=t.direction,f=t.vertical,v=t.options,y=v===void 0?[]:v,m=t.disabled,_=t.defaultValue,g=t.value,w=t.name,p=t.onChange,C=t.className,O=C===void 0?"":C,M=t.motionName,d=M===void 0?"thumb-motion":M,o=He(t,yt),j=s.useRef(null),E=s.useMemo(function(){return ge(j,e)},[j,e]),x=s.useMemo(function(){return vt(y)},[y]),u=Ae((i=x[0])===null||i===void 0?void 0:i.value,{value:g,defaultValue:_}),$=B(u,2),b=$[0],c=$[1],F=s.useState(!1),S=B(F,2),G=S[0],I=S[1],A=function(P,W){c(W),p==null||p(W)},T=ke(o,["children"]),L=s.useState(!1),H=B(L,2),ee=H[0],ae=H[1],$e=s.useState(!1),ne=B($e,2),De=ne[0],ie=ne[1],Re=function(){ie(!0)},Oe=function(){ie(!1)},Me=function(){ae(!1)},Ee=function(P){P.key==="Tab"&&ae(!0)},se=function(P){var W=x.findIndex(function(Ne){return Ne.value===b}),le=x.length,Fe=(W+P+le)%le,te=x[Fe];te&&(c(te.value),p==null||p(te.value))},Pe=function(P){switch(P.key){case"ArrowLeft":case"ArrowUp":se(-1);break;case"ArrowRight":case"ArrowDown":se(1);break}};return s.createElement("div",Z({role:"radiogroup","aria-label":"segmented control",tabIndex:m?void 0:0},T,{className:J(r,(n={},q(n,"".concat(r,"-rtl"),h==="rtl"),q(n,"".concat(r,"-disabled"),m),q(n,"".concat(r,"-vertical"),f),n),O),ref:E}),s.createElement("div",{className:"".concat(r,"-group")},s.createElement(gt,{vertical:f,prefixCls:r,value:b,containerRef:j,motionName:"".concat(r,"-").concat(d),direction:h,getValueIndex:function(P){return x.findIndex(function(W){return W.value===P})},onMotionStart:function(){I(!0)},onMotionEnd:function(){I(!1)}}),x.map(function(D){var P;return s.createElement(bt,Z({},D,{name:w,key:D.value,prefixCls:r,className:J(D.className,"".concat(r,"-item"),(P={},q(P,"".concat(r,"-item-selected"),D.value===b&&!G),q(P,"".concat(r,"-item-focused"),De&&ee&&D.value===b),P)),checked:D.value===b,onChange:A,onFocus:Re,onBlur:Oe,onKeyDown:Pe,onKeyUp:Ee,onMouseDown:Me,disabled:!!m||!!D.disabled}))})))}),_t=xt;function ce(t,e){return{[`${t}, ${t}:hover, ${t}:focus`]:{color:e.colorTextDisabled,cursor:"not-allowed"}}}function ue(t){return{backgroundColor:t.itemSelectedBg,boxShadow:t.boxShadowTertiary}}const jt=Object.assign({overflow:"hidden"},We),pt=t=>{const{componentCls:e}=t,i=t.calc(t.controlHeight).sub(t.calc(t.trackPadding).mul(2)).equal(),n=t.calc(t.controlHeightLG).sub(t.calc(t.trackPadding).mul(2)).equal(),l=t.calc(t.controlHeightSM).sub(t.calc(t.trackPadding).mul(2)).equal();return{[e]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Be(t)),{display:"inline-block",padding:t.trackPadding,color:t.itemColor,background:t.trackBg,borderRadius:t.borderRadius,transition:`all ${t.motionDurationMid} ${t.motionEaseInOut}`}),Ke(t)),{[`${e}-group`]:{position:"relative",display:"flex",alignItems:"stretch",justifyItems:"flex-start",flexDirection:"row",width:"100%"},[`&${e}-rtl`]:{direction:"rtl"},[`&${e}-vertical`]:{[`${e}-group`]:{flexDirection:"column"},[`${e}-thumb`]:{width:"100%",height:0,padding:`0 ${k(t.paddingXXS)}`}},[`&${e}-block`]:{display:"flex"},[`&${e}-block ${e}-item`]:{flex:1,minWidth:0},[`${e}-item`]:{position:"relative",textAlign:"center",cursor:"pointer",transition:`color ${t.motionDurationMid} ${t.motionEaseInOut}`,borderRadius:t.borderRadiusSM,transform:"translateZ(0)","&-selected":Object.assign(Object.assign({},ue(t)),{color:t.itemSelectedColor}),"&-focused":Object.assign({},Ue(t)),"&::after":{content:'""',position:"absolute",zIndex:-1,width:"100%",height:"100%",top:0,insetInlineStart:0,borderRadius:"inherit",opacity:0,transition:`opacity ${t.motionDurationMid}`,pointerEvents:"none"},[`&:hover:not(${e}-item-selected):not(${e}-item-disabled)`]:{color:t.itemHoverColor,"&::after":{opacity:1,backgroundColor:t.itemHoverBg}},[`&:active:not(${e}-item-selected):not(${e}-item-disabled)`]:{color:t.itemHoverColor,"&::after":{opacity:1,backgroundColor:t.itemActiveBg}},"&-label":Object.assign({minHeight:i,lineHeight:k(i),padding:`0 ${k(t.segmentedPaddingHorizontal)}`},jt),"&-icon + *":{marginInlineStart:t.calc(t.marginSM).div(2).equal()},"&-input":{position:"absolute",insetBlockStart:0,insetInlineStart:0,width:0,height:0,opacity:0,pointerEvents:"none"}},[`${e}-thumb`]:Object.assign(Object.assign({},ue(t)),{position:"absolute",insetBlockStart:0,insetInlineStart:0,width:0,height:"100%",padding:`${k(t.paddingXXS)} 0`,borderRadius:t.borderRadiusSM,transition:`transform ${t.motionDurationSlow} ${t.motionEaseInOut}, height ${t.motionDurationSlow} ${t.motionEaseInOut}`,[`& ~ ${e}-item:not(${e}-item-selected):not(${e}-item-disabled)::after`]:{backgroundColor:"transparent"}}),[`&${e}-lg`]:{borderRadius:t.borderRadiusLG,[`${e}-item-label`]:{minHeight:n,lineHeight:k(n),padding:`0 ${k(t.segmentedPaddingHorizontal)}`,fontSize:t.fontSizeLG},[`${e}-item, ${e}-thumb`]:{borderRadius:t.borderRadius}},[`&${e}-sm`]:{borderRadius:t.borderRadiusSM,[`${e}-item-label`]:{minHeight:l,lineHeight:k(l),padding:`0 ${k(t.segmentedPaddingHorizontalSM)}`},[`${e}-item, ${e}-thumb`]:{borderRadius:t.borderRadiusXS}}}),ce(`&-disabled ${e}-item`,t)),ce(`${e}-item-disabled`,t)),{[`${e}-thumb-motion-appear-active`]:{transition:`transform ${t.motionDurationSlow} ${t.motionEaseInOut}, width ${t.motionDurationSlow} ${t.motionEaseInOut}`,willChange:"transform, width"},[`&${e}-shape-round`]:{borderRadius:9999,[`${e}-item, ${e}-thumb`]:{borderRadius:9999}}})}},St=t=>{const{colorTextLabel:e,colorText:i,colorFillSecondary:n,colorBgElevated:l,colorFill:r,lineWidthBold:h,colorBgLayout:f}=t;return{trackPadding:h,trackBg:f,itemColor:e,itemHoverColor:i,itemHoverBg:n,itemSelectedBg:l,itemActiveBg:r,itemSelectedColor:i}},wt=Ve("Segmented",t=>{const{lineWidth:e,calc:i}=t,n=Le(t,{segmentedPaddingHorizontal:i(t.controlPaddingHorizontal).sub(e).equal(),segmentedPaddingHorizontalSM:i(t.controlPaddingHorizontalSM).sub(e).equal()});return[pt(n)]},St);var he=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,n=Object.getOwnPropertySymbols(t);l<n.length;l++)e.indexOf(n[l])<0&&Object.prototype.propertyIsEnumerable.call(t,n[l])&&(i[n[l]]=t[n[l]]);return i};function It(t){return typeof t=="object"&&!!(t!=null&&t.icon)}const Ct=s.forwardRef((t,e)=>{const i=qe(),{prefixCls:n,className:l,rootClassName:r,block:h,options:f=[],size:v="middle",style:y,vertical:m,shape:_="default",name:g=i}=t,w=he(t,["prefixCls","className","rootClassName","block","options","size","style","vertical","shape","name"]),{getPrefixCls:p,direction:C,className:O,style:M}=Ge("segmented"),d=p("segmented",n),[o,j,E]=wt(d),x=Xe(v),u=s.useMemo(()=>f.map(c=>{if(It(c)){const{icon:F,label:S}=c,G=he(c,["icon","label"]);return Object.assign(Object.assign({},G),{label:s.createElement(s.Fragment,null,s.createElement("span",{className:`${d}-item-icon`},F),S&&s.createElement("span",null,S))})}return c}),[f,d]),$=J(l,r,O,{[`${d}-block`]:h,[`${d}-sm`]:x==="small",[`${d}-lg`]:x==="large",[`${d}-vertical`]:m,[`${d}-shape-${_}`]:_==="round"},j,E),b=Object.assign(Object.assign({},M),y);return o(s.createElement(_t,Object.assign({},w,{name:g,className:$,style:b,options:u,ref:e,prefixCls:d,direction:C,vertical:m})))}),$t=Ct,Dt=t=>{let e=[];switch(t){case"organisms":e=[...e,{title:"entity_id",dataIndex:"entity_id",key:"taxonomy_id",render:(i,n)=>a.jsx("a",{href:`https://meshb.nlm.nih.gov/record/ui?ui=${i}`,target:"_blank",children:i})},{title:"entity_name",dataIndex:"entity_name",key:"entity_name",render:(i,n)=>a.jsx(a.Fragment,{children:n!=null&&n.entity_name_en?a.jsx(N,{title:n==null?void 0:n.entity_name_en,children:i}):a.jsx(a.Fragment,{children:i})})},{title:"taxonomy_name",dataIndex:"taxonomy_name",key:"taxonomy_name"},{title:"rank",dataIndex:"rank",key:"rank"},{title:"tax_id",dataIndex:"tax_id",key:"tax_id"},{title:"entity_type",dataIndex:"entity_type",key:"entity_type"},{title:"has_children",dataIndex:"has_children",key:"has_children",render:(i,n)=>i?"exist":"non-existent"},{title:"is_exist_graph",dataIndex:"is_exist_graph",key:"is_exist_graph",render:(i,n)=>i?"exist":"non-existent"}];break;case"mesh":e=[...e,{title:"entity_id",dataIndex:"entity_id",key:"taxonomy_id",render:(i,n)=>a.jsx("a",{href:`https://meshb.nlm.nih.gov/record/ui?ui=${i}`,target:"_blank",children:i})},{title:"entity_name",dataIndex:"entity_name",key:"entity_name",render:(i,n)=>a.jsx(a.Fragment,{children:n!=null&&n.entity_name_en?a.jsx(N,{title:n==null?void 0:n.entity_name_en,children:i}):a.jsx(a.Fragment,{children:i})})},{title:"short_name",dataIndex:"short_name",key:"short_name",render:(i,n)=>a.jsx(a.Fragment,{children:i&&Array.isArray(i)&&i.map((l,r)=>a.jsx(oe,{children:l},r))})},{title:"entity_type",dataIndex:"entity_type",key:"entity_type"},{title:"has_children",dataIndex:"has_children",key:"has_children",render:(i,n)=>i?"exist":"non-existent"},{title:"is_exist_graph",dataIndex:"is_exist_graph",key:"is_exist_graph",render:(i,n)=>i?"exist":"non-existent"},{title:"is_research",dataIndex:"is_research",key:"is_research",render:(i,n)=>i?"research":"non-research"},{title:"tags",dataIndex:"tags",key:"tags",render:(i,n)=>a.jsx(a.Fragment,{children:i&&Array.isArray(i)&&i.map((l,r)=>a.jsx(oe,{children:l},r))})}];break;case"association":e=[{title:"entity_id",dataIndex:"entity_id",key:"entity_id"},{title:"subject_name",dataIndex:"subject_name",key:"subject_name",render:(i,n)=>a.jsx(a.Fragment,{children:a.jsx(N,{title:n==null?void 0:n.subject_id,children:i})})},{title:"predicate",dataIndex:"predicate",key:"predicate"},{title:"object_name",dataIndex:"object_name",key:"object_name",render:(i,n)=>a.jsx(a.Fragment,{children:a.jsx(N,{title:n==null?void 0:n.object_id,children:i})})},{title:"effect",dataIndex:"effect",key:"effect"},{title:"study_name",dataIndex:"study_name",key:"study_name",render:(i,n)=>a.jsx(a.Fragment,{children:a.jsx(N,{title:n==null?void 0:n.study_id,children:i})})},{title:"observed_name",dataIndex:"observed_name",key:"observed_name",render:(i,n)=>a.jsx(a.Fragment,{children:a.jsx(N,{title:n==null?void 0:n.observed_id,children:i})})}];break;default:e=[{title:"entity_id",dataIndex:"entity_id",key:"taxonomy_id"},{title:"entity_name",dataIndex:"entity_name",key:"entity_name"},{title:"has_children",dataIndex:"has_children",key:"has_children",render:(i,n)=>i?"exist":"non-existent"},{title:"is_exist_graph",dataIndex:"is_exist_graph",key:"is_exist_graph",render:(i,n)=>i?"exist":"non-existent"},{title:"is_research",dataIndex:"is_research",key:"is_research",render:(i,n)=>i?"research":"non-research"}]}return e},Rt=s.forwardRef(({columnType:t,rowSelection:e,openModal:i,entityType:n,params:l,close:r},h)=>{const[f,v]=s.useState(!0),{locale:y}=Je(),[m]=s.useState(30),{data:_,pageNumber:g,totalPage:w,loading:p,reload:C,pageSize:O,setPageSize:M,setPageNumber:d,search:o}=at({url:`/entity/page/${n}`,initialPageSize:m,params:{...l,is_research:f,locale:y}});s.useImperativeHandle(h,()=>({reload:C,setPageNumber:d})),Ye();const{messageApi:j}=fe(),E=[...Dt(t||n),{title:"操作",key:"action",fixed:"right",width:200,render:(x,u)=>a.jsx(nt,{size:"middle",children:i&&a.jsxs(a.Fragment,{children:[a.jsx(X,{size:"small",color:"cyan",variant:"solid",onClick:()=>{i("entityDetailsModal",{entityType:n,entityId:u.entity_id})},children:"details"}),a.jsx(X,{size:"small",color:"cyan",variant:"solid",onClick:()=>{console.log("update:",u),i("optModal",{entityType:n,entityId:u.entity_id})},children:"update"}),u.is_exist_graph?a.jsxs(a.Fragment,{children:[a.jsx(X,{size:"small",color:"cyan",variant:"solid",onClick:()=>{i("graphView",{entityType:n,entityId:u.entity_id,entityName:u.entity_name})},children:"network"}),a.jsx(re,{title:"确认删除节点?",onConfirm:async()=>{var $,b,c,F;try{await U.delete(`/entity/delete-node/${n}/${u.entity_id}`),j.success("删除成功!"),C()}catch(S){console.log((b=($=S==null?void 0:S.response)==null?void 0:$.data)==null?void 0:b.detail),j.error((F=(c=S==null?void 0:S.response)==null?void 0:c.data)==null?void 0:F.detail)}},children:a.jsx(X,{size:"small",danger:!0,variant:"solid",children:"delete"})})]}):a.jsx(re,{title:"Confirm deletion?",onConfirm:async()=>{var $,b,c,F;try{await U.delete(`/entity/delete/${n}/${u.entity_id}`),j.success("Delete successfully!"),C()}catch(S){console.log((b=($=S==null?void 0:S.response)==null?void 0:$.data)==null?void 0:b.detail),j.error((F=(c=S==null?void 0:S.response)==null?void 0:c.data)==null?void 0:F.detail)}},children:a.jsx(X,{size:"small",danger:!0,variant:"solid",children:"delete"})})]})})}];return a.jsx("div",{children:a.jsx(it,{title:()=>a.jsxs(Y,{justify:"space-between",children:[a.jsxs(Y,{gap:"small",align:"center",children:[n!="association"&&a.jsx(je,{value:f,onChange:v,checkedChildren:"filter",unCheckedChildren:"all",size:"small",defaultChecked:!0}),a.jsx(K.Search,{size:"small",placeholder:"search...",allowClear:!0,enterButton:!0,onSearch:x=>{o(x)},style:{width:300}})]}),a.jsxs(Y,{gap:"small",children:[a.jsx(N,{title:"create",children:a.jsx(ct,{onClick:()=>{l!=null&&l.category?i("optModal",{entityType:n,category:l==null?void 0:l.category}):i("optModal",{entityType:n})}})}),a.jsx(N,{title:"refresh",children:a.jsx(mt,{onClick:()=>C()})}),r&&a.jsx(Ze,{onClick:r})]})]}),rowSelection:e,rowKey:x=>x.entity_id,size:"small",bordered:!0,pagination:!1,loading:p,scroll:{x:"max-content"},columns:E,dataSource:_,footer:()=>a.jsx(a.Fragment,{children:w!=0&&a.jsxs(Y,{style:{marginTop:"1rem"},align:"center",gap:"small",children:[a.jsxs("p",{children:["A total of ",w," data "]}),a.jsx(st,{size:"small",current:g,pageSize:O,total:w,onChange:x=>d(x),showSizeChanger:!1}),a.jsx(V,{size:"small",value:O,onChange:M,options:[{key:10,value:10},{key:30,value:30},{key:50,value:50}]})]})})})})}),{Option:Gt}=V,Ot=({})=>{const[t,e]=s.useState("study"),[i,n]=s.useState("disease"),l=R.useFormInstance(),[r,h]=s.useState([]),[f,v]=s.useState([]),{modals:y,openModals:m,closeModals:_}=ve(["entityDrawer"]),[g,w]=s.useState();return a.jsxs(a.Fragment,{children:[a.jsx(R.Item,{label:"Study",name:"study_id",children:a.jsx(K,{placeholder:"which study or reference provides evidence",style:{cursor:"pointer"},onClick:()=>m("entityDrawer",{name:"study_id"})})}),a.jsx(R.Item,{label:"Subject",name:"subject_id",children:a.jsx(K,{placeholder:"who does something",style:{cursor:"pointer"},onClick:()=>m("entityDrawer",{name:"subject_id"})})}),a.jsx(R.Item,{label:"Object",name:"object_id",children:a.jsx(K,{placeholder:"who receives the effect",style:{cursor:"pointer"},onClick:()=>m("entityDrawer",{name:"object_id"})})}),a.jsx(R.Item,{label:"Predicate",name:"predicate",children:a.jsx(V,{allowClear:!0,options:[{value:"CORRELATED_WITH",label:"CORRELATED_WITH"},{value:"PRODUCES",label:"PRODUCES"},{value:"MODULATES",label:"MODULATES"},{value:"ACTIVATES",label:"ACTIVATES"},{value:"INHIBITS",label:"INHIBITS"}]})}),a.jsx(R.Item,{label:"effect",name:"effect",children:a.jsx(V,{allowClear:!0,options:[{value:"Up",label:"Up"},{value:"Down",label:"Down"}]})}),a.jsx(R.Item,{label:"Observed",name:"observed_id",children:a.jsx(K,{placeholder:"where the phenomenon is observed (e.g., patient group, tissue, condition)",style:{cursor:"pointer"},onClick:()=>m("entityDrawer",{name:"observed_id"})})}),a.jsx(Mt,{form:l,setRecord:w,visible:y.entityDrawer.visible,params:y.entityDrawer.params,onClose:()=>_("entityDrawer")})]})},Mt=({visible:t,setRecord:e,form:i,params:n,onClose:l,callback:r})=>a.jsx(a.Fragment,{children:a.jsx(pe,{open:t,onClose:l,width:"80%",children:t&&a.jsx(Ce,{disableWidth:!0,rowSelection:{onChange:(h,f)=>{i.setFieldValue(n.name,f[0].entity_id),l()},type:"radio"}})})}),Et=()=>a.jsxs(a.Fragment,{children:[a.jsx(R.Item,{label:"entity_name_zh",name:"entity_name_zh",children:a.jsx(K,{})}),a.jsx(R.Item,{label:"entity_type",name:"entity_type",rules:[{required:!0,message:"该字段不能为空!"}],children:a.jsx(V,{allowClear:!0,options:[{value:"Microbe",label:"Microbe"},{value:"Disease",label:"Disease"},{value:"Pathway",label:"Pathway"},{value:"Pathway",label:"Pathway"},{value:"Compound",label:"compound"},{value:"evidence",label:"Evidence"}]})}),a.jsx(R.Item,{name:"tags",label:"tags",children:a.jsx(V,{mode:"tags",style:{width:"100%"}})}),a.jsx(R.Item,{name:"short_name",label:"short_name",children:a.jsx(V,{mode:"tags",style:{width:"100%"}})})]}),Se=({visible:t,params:e,onClose:i,record:n,callback:l,children:r})=>{const[h]=R.useForm(),{messageApi:f}=fe(),[v,y]=s.useState(!1);s.useEffect(()=>{console.log("11111",e),t&&(e!=null&&e.entityId)?m():h.resetFields()},[t]);const m=async()=>{y(!0);const g=await U.get(`/entity/get/${e.entityType}/${e.entityId}`);h.setFieldsValue(g.data),y(!1)},_=async()=>{y(!0);const g=await h.validateFields();e!=null&&e.entityId?await U.put(`/entity/update/${e.entityType}/${e.entityId}`,g):await U.post(`/entity/add/${e.entityType}`,g),y(!1),i(),l&&l(),f.success("操作成功!")};return a.jsx(be,{loading:v,title:e!=null&&e.entityId?"update entity":"create entity",onOk:_,width:"50%",open:t,onClose:i,onCancel:i,children:a.jsxs(R,{form:h,children:[r,a.jsx(Qe,{ghost:!0,items:[{key:"1",label:"more",children:a.jsx(a.Fragment,{children:a.jsx(R.Item,{noStyle:!0,shouldUpdate:!0,children:()=>a.jsx(et,{children:a.jsx("pre",{children:JSON.stringify(h.getFieldsValue(),null,2)})})})})}]})]})})},Pt={mesh:Et},Ft=({type:t,record:e})=>{const i=Pt[t]||(()=>a.jsxs("div",{children:["no ",t," component!"]}));return a.jsx(i,{record:e})},Nt=({...t})=>{const{params:e,record:i}=t,[n,l]=s.useState([]);return s.useEffect(()=>{if(l([]),e!=null&&e.category&&Array.isArray(e==null?void 0:e.category)){const r=e==null?void 0:e.category.map(h=>({label:h,value:h}));l(r)}},[e]),a.jsx(a.Fragment,{children:a.jsxs(Se,{...t,children:[!(e!=null&&e.entityId)&&a.jsx(R.Item,{label:"category",name:"category",rules:[{required:!0,message:"该字段不能为空!"}],children:a.jsx(V,{options:n})}),a.jsx(R.Item,{label:"is_research",name:"is_research",children:a.jsx(je,{})}),a.jsx(R.Item,{label:"entity_name",name:"entity_name",rules:[{required:!0,message:"该字段不能为空!"}],children:a.jsx(K,{})}),a.jsx(Ft,{type:e==null?void 0:e.entityType,record:i})]})})},Xt=({...t})=>a.jsx(a.Fragment,{children:a.jsx(Se,{...t,children:a.jsx(Ot,{})})}),we=(t,e,i)=>t.map(n=>n.key===e?{...n,children:i}:n.children?{...n,children:we(n.children,e,i)}:n),zt=s.forwardRef(({entityType:t,params:e},i)=>{const[n,l]=s.useState(),[r,h]=s.useState(new Set),[f,v]=s.useState(),[y,m]=s.useState("default"),_=async(d,o,j,E="")=>{const x=await U.post(`/entity/page/${t}`,{page_number:o,page_size:j,parent_id:String(d),keyword:E,...e}),{items:u,total:$}=x.data;if(t=="taxonomy"){const b=u.map(c=>({title:a.jsx(a.Fragment,{children:a.jsxs(N,{title:`${c.entity_name}(${c.rank})(${c.tax_id})`,children:[c.entity_name," (",c.rank,")"]})}),key:c.tax_id,isLeaf:!c.has_children}));return v(b),{children:b,total:$}}else if(t=="mesh"){const b=u.map(c=>({title:a.jsx(a.Fragment,{children:a.jsxs(N,{title:`${c.entity_name}`,children:[c.entity_name,"(",c.entity_id,")"]})}),key:c.tree_number,isLeaf:!c.has_children}));return v(b),{children:b,total:$}}else{const b=u.map(c=>({title:a.jsx(a.Fragment,{children:a.jsx(N,{title:`${c.entity_name}`,children:c.entity_name})}),key:c.entity_id,isLeaf:!c.has_children}));return v(b),{children:b,total:$}}},g=async()=>{const{children:d}=await _(y,1,-1);l(d)};s.useImperativeHandle(i,()=>({reload:g})),s.useEffect(()=>{g()},[t,JSON.stringify(e)]);const w=async({key:d,children:o})=>{if(o)return;h(E=>new Set(E).add(d));const{children:j}=await _(d,1,-1);l(E=>we(E,d,[...j])),h(E=>{const x=new Set(E);return x.delete(d),x})},p=s.useRef(null),[C,O]=s.useState(null),M=()=>{if(p.current){const d=p.current.getBoundingClientRect().top;O(window.innerHeight-d)}};return s.useEffect(()=>(M(),window.addEventListener("resize",M),()=>{window.removeEventListener("resize",M)}),[]),a.jsx("div",{ref:p,children:n?a.jsx(a.Fragment,{children:a.jsx(_e,{height:C,loadData:w,treeData:n,showLine:!0,titleRender:d=>r.has(Number(d.key))?a.jsx(lt,{size:"small"}):d.title})}):a.jsx(xe,{active:!0})})}),Tt=s.lazy(()=>tt(()=>import("./graph-view-BxwqRE5_.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]),import.meta.url)),Ie=s.forwardRef(({openModals:t,rowSelection:e,disableWidth:i=!1},n)=>{const[l,r]=s.useState("mesh"),[h,f]=s.useState(),[v,y]=s.useState(),[m,_]=s.useState("mental_disorders"),g=s.useRef(null),[w,p]=s.useState("table"),C=()=>{var o;(o=g.current)==null||o.reload()},O=o=>{var j;g.current&&((j=g.current)==null||j.setPageNumber(o))},M=[{key:"mental_disorders",label:"Mental Disorders"},{key:"organisms",label:"Microbe"},{key:"mesh-KEGG",label:"KEGG"},{key:"chemicals_and_drugs",label:"Chemicals and Drugs"},{key:"evidence",label:"Research Evidence"}],d=o=>{if(o.startsWith("mesh")){r("mesh");const j=o.split("-")[1];y({category:[j]})}else o=="organisms"?(r("mesh"),f("organisms"),y({category:["B02","B03","B04"],registry_join:"taxonomy"})):o=="mental_disorders"?(r("mesh"),y({category:["F03","C10","F01"]})):o=="chemicals_and_drugs"?(r("mesh"),y({category:["D01","D02","D03","D04","D05","D06","D08","D09","D10","D12","D13","D20","D23","D25","D26","D27"]})):o=="evidence"?(r("mesh"),y({category:["evidence"]})):r(o)};return s.useImperativeHandle(n,()=>({reload:C})),a.jsxs("div",{style:i?{}:{maxWidth:"1500px",margin:"1rem auto"},children:[a.jsx("div",{style:{marginBottom:"1rem"},children:" "}),a.jsx(rt,{size:"small",activeKey:m,onChange:o=>{d(o),_(o),O(1)},tabBarExtraContent:a.jsx(a.Fragment,{children:a.jsx($t,{size:"small",value:w,onChange:o=>p(o),options:[{label:"table",value:"table"},{label:"tree",value:"tree"}]})}),items:M}),w=="table"&&a.jsx(a.Fragment,{children:a.jsx(Rt,{columnType:h,rowSelection:e,ref:g,openModal:t,params:v,entityType:l})}),w=="tree"&&a.jsx(a.Fragment,{children:a.jsx(zt,{ref:g,entityType:l,params:v})})]})}),Ce=({...t})=>{const{modals:e,openModals:i,closeModals:n}=ve(["entityPage","optModal","graphView","entityDrawer","entityDetailsModal"]),l=s.useRef(null),r=()=>{var h;(h=l.current)==null||h.reload()};return a.jsxs(a.Fragment,{children:[a.jsx(Ie,{...t,ref:l,openModals:i}),a.jsx(Nt,{openModals:i,callback:r,visible:e.optModal.visible,params:e.optModal.params,onClose:()=>n("optModal")}),a.jsx(Ht,{callback:r,visible:e.graphView.visible,params:e.graphView.params,onClose:()=>n("graphView")}),a.jsx(At,{openModals:i,callback:r,visible:e.entityDetailsModal.visible,params:e.entityDetailsModal.params,onClose:()=>n("entityDetailsModal")})]})},Ht=({visible:t,params:e,onClose:i,callback:n})=>a.jsx(be,{title:e==null?void 0:e.entityName,width:"60%",footer:null,open:t,onClose:i,onCancel:i,children:a.jsx(s.Suspense,{fallback:a.jsx(xe,{active:!0}),children:a.jsx(Tt,{entity_id:e==null?void 0:e.entityId})})}),At=({visible:t,params:e,onClose:i})=>{const[n,l]=s.useState(!1),[r,h]=s.useState(),[f,v]=s.useState(),y=_=>_.map(g=>({title:g.entity_name,key:g.entity_id,children:g.children?y(g.children):[]})),m=async()=>{l(!0);const _=await U.get(`/entity/get/${e.entityType}/${e.entityId}`),g=y(_.data.parents);v(g),l(!1)};return s.useEffect(()=>{e!=null&&e.entityId&&m()},[e==null?void 0:e.entityId]),a.jsx(pe,{open:t,onClose:i,width:"40%",loading:n,children:f&&a.jsx(a.Fragment,{children:a.jsx(_e,{treeData:f,defaultExpandAll:!0,showLine:!0,selectable:!0})})})},Jt=Object.freeze(Object.defineProperty({__proto__:null,EntityView:Ie,default:Ce},Symbol.toStringTag,{value:"Module"}));export{Xt as A,Rt as D,ct as R,mt as a,Jt as i};
