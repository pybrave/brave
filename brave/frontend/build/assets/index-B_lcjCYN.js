import{r as i,y as T,_ as V,I as F,u as $,c as G,k as W,b as D,j as s,F as m,B as k,R as B,C as z,P as H,a0 as U,a as C,s as K,t as R,l as A,E as M,M as J,a1 as q}from"./main-qdx71IeZ.js";import{C as L,M as O}from"./index-EOZAs8C8.js";import{c as E}from"./utils-D2B0dIuM.js";import{b as Q,p as X}from"./index-B_yuV5-A.js";import{u as Y}from"./usePagination-B91F5N18.js";import{D as Z}from"./index-D4KDMA4T.js";import{S as N,P as ee}from"./index-DzNw07ei.js";import{T as se}from"./index-CssIxjBA.js";import{S as te}from"./index-C_udHuuV.js";import{R as P}from"./RedoOutlined-CpHCHwbd.js";import{R as oe}from"./DownloadOutlined-lpdqma_y.js";import"./index-DyzH6iix.js";import"./Table-BlsL6kCC.js";import"./addEventListener-gnMpRr3K.js";import"./Dropdown-DsoEvqJ1.js";import"./index-DypQT-Hh.js";import"./UpOutlined-W4L3zuBA.js";import"./DeleteOutlined-CuopAM2r.js";var ae={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908 640H804V488c0-4.4-3.6-8-8-8H548v-96h108c8.8 0 16-7.2 16-16V80c0-8.8-7.2-16-16-16H368c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h108v96H228c-4.4 0-8 3.6-8 8v152H116c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h288c8.8 0 16-7.2 16-16V656c0-8.8-7.2-16-16-16H292v-88h440v88H620c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h288c8.8 0 16-7.2 16-16V656c0-8.8-7.2-16-16-16zm-564 76v168H176V716h168zm84-408V140h168v168H428zm420 576H680V716h168v168z"}}]},name:"apartment",theme:"outlined"},ne=function(n,t){return i.createElement(T,V({},n,{ref:t,icon:ae}))},re=i.forwardRef(ne);const ke=({params:c,map:n})=>{const{Search:t}=F,{baseURL:j}=$(e=>e.user),{component_type:g}=c,w=e=>(n&&(e=n(e)),e.tags&&(e.tags=JSON.parse(e.tags)),{id:e.id,component_id:e.component_id,name:e.name,category:e.category,img:e.img,tags:e.tags,component_type:e.component_type,order:e.order_index,path:`/component/${g}/${e.component_id}`,namespace:e.namespace,namespace_name:e.namespace_name}),{data:p,pageNumber:v,totalPage:u,loading:h,reload:r,pageSize:b,setPageNumber:S,search:_}=Y({pageApi:X,params:c||{},map:w,initialPageSize:12}),d=G(),{messageApi:I}=W(),{modal:a,openModal:l,closeModal:x}=D();return s.jsxs("div",{style:{maxWidth:"1500px",margin:"1rem auto"},children:[s.jsxs(m,{justify:"space-between",gap:"small",children:[s.jsx(t,{size:"small",placeholder:"Search Components",allowClear:!0,enterButton:!0,onSearch:e=>{_(e)},style:{marginBottom:"1rem",width:400}}),s.jsxs(m,{gap:"small",children:[s.jsx(k,{size:"small",color:"cyan",variant:"solid",onClick:()=>{l("installComponents",{component_type:g})},children:"Intsall Components "}),s.jsx(k,{size:"small",color:"cyan",variant:"solid",onClick:()=>{l("modalA",{data:void 0,structure:{component_type:g}})},children:"Create Components "}),s.jsx(k,{size:"small",color:"primary",variant:"solid",onClick:r,children:"Refresh"})]})]}),s.jsx(N,{spinning:h,children:Array.isArray(p)&&p.length!=0?s.jsx(B,{gutter:16,style:{position:"relative"},children:p.map((e,y)=>s.jsx(z,{lg:6,sm:4,xs:24,style:{marginBottom:"1rem",cursor:"pointer"},children:s.jsxs(L,{hoverable:!0,className:"custom-card",style:{height:"100%",border:"1px solid #f0f0f0",borderRadius:"12px",overflow:"hidden",transition:"all 0.3s ease"},bodyStyle:{padding:"12px 16px"},cover:s.jsx("div",{style:{height:"15rem"},children:s.jsx("img",{style:{height:"100%",width:"100%",objectFit:"cover"},alt:e.label,src:`${j}${e.img}`})}),onClick:()=>d(`${e.path}`),children:[s.jsx(O,{title:s.jsxs(m,{gap:"small",children:[s.jsx("span",{children:e.name}),s.jsx(H,{title:"Copy component ?",onConfirm:async o=>{o.stopPropagation(),await C.post(`/copy-component/${e.component_id}`),K.success("Component copied!"),r()},children:s.jsx(U,{onClick:o=>{o.stopPropagation()}})})]}),description:e==null?void 0:e.description,style:{marginBottom:"1rem"}}),e.tags&&Array.isArray(e.tags)&&e.tags.map((o,f)=>s.jsx(R,{title:o,children:s.jsx(A,{style:{wordBreak:"break-word",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:100,display:"inline-block",cursor:"default"},color:E[f],children:o})},f)),s.jsx("div",{onClick:o=>{o.stopPropagation(),l("modalG",e)},style:{position:"absolute",right:10,bottom:10,fontSize:15,color:"rgba(0,0,0,0.45)",cursor:"pointer"},children:s.jsx(re,{})})]})},y))}):s.jsx(M,{})}),u!=0&&s.jsxs(m,{style:{marginTop:"1rem"},align:"center",children:["一共",u,"条数据  ",s.jsx(ee,{current:v,pageSize:b,total:u,onChange:e=>S(e),showSizeChanger:!1})]}),s.jsx(Q,{callback:r,visible:a.key=="modalA"&&a.visible,onClose:x,params:a.params}),s.jsx(Z,{visible:a.key=="modalG"&&a.visible,onClose:x,callback:r,params:a.params}),s.jsx(le,{visible:a.key=="installComponents"&&a.visible,onClose:x,callback:r,params:a.params})]})},le=({visible:c,onClose:n,params:t,callback:j})=>{const[g,w]=i.useState([]),[p,v]=i.useState([]),[u,h]=i.useState(!1),[r,b]=i.useState(),{baseURL:S}=$(e=>e.user),_=q(),[d,I]=i.useState("github");i.useEffect(()=>{c&&(t!=null&&t.component_type)&&a()},[c,t==null?void 0:t.component_type,d]);const a=async()=>{try{h(!0);const e=await C.get(`/component-store/list-stores?address=${d}`);w(e.data),e.data.length>0?(b(e.data[0].store_name),l(e.data[0].store_name)):v([]),h(!1)}catch{}},l=async(e,y=void 0)=>{h(!0);const o=await C.post("/component-store/list-components",{store_name:e,component_type:t==null?void 0:t.component_type,address:d,remote_force:y});v(o.data),h(!1)},x=e=>e.startsWith("http")?e:`${S}${e}`;return s.jsx(J,{footer:null,title:s.jsxs(m,{gap:"small",children:[s.jsxs("span",{children:["Install Components"," "]}),s.jsx(P,{style:{cursor:"pointer"},onClick:()=>{d=="github"?l(r,!0):l(r)}})]}),width:"90%",open:c,onClose:n,onCancel:n,children:s.jsxs(N,{spinning:u,children:[s.jsx(se,{tabBarExtraContent:s.jsxs(s.Fragment,{children:[s.jsx(te,{value:d,options:[{label:"Github",value:"github"},{label:"Local",value:"local"}],onChange:e=>{I(e)}}),s.jsx(P,{style:{cursor:"pointer"},onClick:()=>a()})]}),activeKey:r,onChange:e=>{b(e),l(e)},items:g.map(e=>({key:e.store_name,label:e.name}))}),Array.isArray(p)&&p.length!=0?s.jsx(B,{gutter:16,style:{position:"relative"},children:p.map((e,y)=>s.jsx(z,{lg:4,sm:4,xs:24,style:{marginBottom:"1rem",cursor:"pointer"},children:s.jsxs(L,{hoverable:!0,className:"custom-card",style:{height:"100%",border:"1px solid #f0f0f0",borderRadius:"12px",overflow:"hidden",transition:"all 0.3s ease"},bodyStyle:{padding:"12px 16px"},cover:s.jsx("div",{style:{height:"15rem"},children:s.jsx("img",{style:{height:"100%",width:"100%",objectFit:"cover"},alt:e.label,src:x(e.img)})}),children:[s.jsx(O,{title:s.jsxs(m,{justify:"space-between",align:"center",children:[s.jsxs(R,{title:e==null?void 0:e.component_id,children:[e.component_name,s.jsx(A,{color:e.installed?"#108ee9":"#f5222d",style:{marginLeft:"1rem"},children:e.installed?"Installed":"Not I nstalled"})]}),s.jsx(H,{okButtonProps:{color:`${e.installed?"red":"blue"}`,variant:"solid"},okText:e.installed?"Reinstall":"Install",title:e.installed?`Reinstall ${e.component_name} ?`:`Install ${e.component_name} ?`,onConfirm:async()=>{await C.post("/install-components",{path:e.file_path,force:!0,address:e.address,branch:e.branch},{timeout:6e4}),_.success(e.installed?"Reinstall success!":"Install success!"),j&&j(),n&&n()},children:s.jsx(oe,{style:{cursor:"pointer"}})})]}),description:e==null?void 0:e.description,style:{marginBottom:"1rem"}}),e.tags&&Array.isArray(e.tags)&&e.tags.map((o,f)=>s.jsx(R,{title:o,children:s.jsx(A,{style:{wordBreak:"break-word",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:100,display:"inline-block",cursor:"default"},color:E[f],children:o})},f))]})},y))}):s.jsx(M,{})]})})};export{ke as default};
