const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./graph-view-BUJAksbS.js","./main-DWRmJItp.js","./main-DLoYsyAm.css","./index-CIC2lPJU.js","./index-BL5qaRD0.js","./Dropdown-CRhi--nO.js","./index-CRfZL3ek.js","./study-page-5miJ3Sva.js","./usePagination-BbrBuRX4.js","./Table-CorKTwZX.js","./addEventListener-BBJtVQmZ.js","./index-CJtHLx1t.js","./RedoOutlined-BHUbUeEq.js","./index-BEHP9AIO.js","./NodeIndexOutlined-BPhdsDfZ.js","./index-C6NESaM6.js"])))=>i.map(i=>d[i]);
import{r as s,ad as B,aN as Ee,aj as Pe,ac as Y,O as J,ak as ye,ag as Te,ax as Ne,aO as He,_ as le,ae as W,aw as ge,Z as ze,$ as ke,a0 as Ae,a2 as Ve,a1 as z,aP as Le,aC as Be,aQ as Ke,a5 as Ue,a6 as We,F as C,q as fe,j as n,I as q,S as K,d as qe,a as k,M as be,i as Ge,c as Xe,t as ve,o as N,B as L,P as ee,aL as Je}from"./main-DWRmJItp.js";import{S as Ye,D as Ze}from"./study-page-5miJ3Sva.js";import{T as xe,S as oe}from"./Table-CorKTwZX.js";import{S as Qe}from"./index-CRfZL3ek.js";import{T as de}from"./index-BEHP9AIO.js";import{T as et}from"./index-BL5qaRD0.js";import{D as te}from"./index-C6NESaM6.js";import{S as tt}from"./index-CJtHLx1t.js";var ce=function(e,i){if(!e)return null;var a={left:e.offsetLeft,right:e.parentElement.clientWidth-e.clientWidth-e.offsetLeft,width:e.clientWidth,top:e.offsetTop,bottom:e.parentElement.clientHeight-e.clientHeight-e.offsetTop,height:e.clientHeight};return i?{left:0,right:0,width:0,top:a.top,bottom:a.bottom,height:a.height}:{left:a.left,right:a.right,width:a.width,top:0,bottom:0,height:0}},E=function(e){return e!==void 0?"".concat(e,"px"):void 0};function nt(t){var e=t.prefixCls,i=t.containerRef,a=t.value,r=t.getValueIndex,l=t.motionName,u=t.onMotionStart,c=t.onMotionEnd,m=t.direction,y=t.vertical,o=y===void 0?!1:y,d=s.useRef(null),x=s.useState(a),_=B(x,2),p=_[0],M=_[1],O=function(H){var P,V=r(H),T=(P=i.current)===null||P===void 0?void 0:P.querySelectorAll(".".concat(e,"-item"))[V];return(T==null?void 0:T.offsetParent)&&T},g=s.useState(null),h=B(g,2),b=h[0],D=h[1],$=s.useState(null),w=B($,2),v=w[0],F=w[1];Ee(function(){if(p!==a){var j=O(p),H=O(a),P=ce(j,o),V=ce(H,o);M(a),D(P),F(V),j&&H?u():c()}},[a]);var S=s.useMemo(function(){if(o){var j;return E((j=b==null?void 0:b.top)!==null&&j!==void 0?j:0)}return E(m==="rtl"?-(b==null?void 0:b.right):b==null?void 0:b.left)},[o,m,b]),f=s.useMemo(function(){if(o){var j;return E((j=v==null?void 0:v.top)!==null&&j!==void 0?j:0)}return E(m==="rtl"?-(v==null?void 0:v.right):v==null?void 0:v.left)},[o,m,v]),G=function(){return o?{transform:"translateY(var(--thumb-start-top))",height:"var(--thumb-start-height)"}:{transform:"translateX(var(--thumb-start-left))",width:"var(--thumb-start-width)"}},A=function(){return o?{transform:"translateY(var(--thumb-active-top))",height:"var(--thumb-active-height)"}:{transform:"translateX(var(--thumb-active-left))",width:"var(--thumb-active-width)"}},X=function(){D(null),F(null),c()};return!b||!v?null:s.createElement(Pe,{visible:!0,motionName:l,motionAppear:!0,onAppearStart:G,onAppearActive:A,onVisibleChanged:X},function(j,H){var P=j.className,V=j.style,T=Y(Y({},V),{},{"--thumb-start-left":S,"--thumb-start-width":E(b==null?void 0:b.width),"--thumb-active-left":f,"--thumb-active-width":E(v==null?void 0:v.width),"--thumb-start-top":S,"--thumb-start-height":E(b==null?void 0:b.height),"--thumb-active-top":f,"--thumb-active-height":E(v==null?void 0:v.height)}),Z={ref:ye(d,H),style:T,className:J("".concat(e,"-thumb"),P)};return s.createElement("div",Z)})}var at=["prefixCls","direction","vertical","options","disabled","defaultValue","value","name","onChange","className","motionName"];function it(t){if(typeof t.title<"u")return t.title;if(ge(t.label)!=="object"){var e;return(e=t.label)===null||e===void 0?void 0:e.toString()}}function st(t){return t.map(function(e){if(ge(e)==="object"&&e!==null){var i=it(e);return Y(Y({},e),{},{title:i})}return{label:e==null?void 0:e.toString(),title:e==null?void 0:e.toString(),value:e}})}var rt=function(e){var i=e.prefixCls,a=e.className,r=e.disabled,l=e.checked,u=e.label,c=e.title,m=e.value,y=e.name,o=e.onChange,d=e.onFocus,x=e.onBlur,_=e.onKeyDown,p=e.onKeyUp,M=e.onMouseDown,O=function(h){r||o(h,m)};return s.createElement("label",{className:J(a,W({},"".concat(i,"-item-disabled"),r)),onMouseDown:M},s.createElement("input",{name:y,className:"".concat(i,"-item-input"),type:"radio",disabled:r,checked:l,onChange:O,onFocus:d,onBlur:x,onKeyDown:_,onKeyUp:p}),s.createElement("div",{className:"".concat(i,"-item-label"),title:c,"aria-selected":l},u))},lt=s.forwardRef(function(t,e){var i,a,r=t.prefixCls,l=r===void 0?"rc-segmented":r,u=t.direction,c=t.vertical,m=t.options,y=m===void 0?[]:m,o=t.disabled,d=t.defaultValue,x=t.value,_=t.name,p=t.onChange,M=t.className,O=M===void 0?"":M,g=t.motionName,h=g===void 0?"thumb-motion":g,b=Te(t,at),D=s.useRef(null),$=s.useMemo(function(){return ye(D,e)},[D,e]),w=s.useMemo(function(){return st(y)},[y]),v=Ne((i=w[0])===null||i===void 0?void 0:i.value,{value:x,defaultValue:d}),F=B(v,2),S=F[0],f=F[1],G=s.useState(!1),A=B(G,2),X=A[0],j=A[1],H=function(R,U){f(U),p==null||p(U)},P=He(b,["children"]),V=s.useState(!1),T=B(V,2),Z=T[0],ne=T[1],we=s.useState(!1),ae=B(we,2),Ie=ae[0],ie=ae[1],Ce=function(){ie(!0)},$e=function(){ie(!1)},De=function(){ne(!1)},Re=function(R){R.key==="Tab"&&ne(!0)},se=function(R){var U=w.findIndex(function(Fe){return Fe.value===S}),re=w.length,Oe=(U+R+re)%re,Q=w[Oe];Q&&(f(Q.value),p==null||p(Q.value))},Me=function(R){switch(R.key){case"ArrowLeft":case"ArrowUp":se(-1);break;case"ArrowRight":case"ArrowDown":se(1);break}};return s.createElement("div",le({role:"radiogroup","aria-label":"segmented control",tabIndex:o?void 0:0},P,{className:J(l,(a={},W(a,"".concat(l,"-rtl"),u==="rtl"),W(a,"".concat(l,"-disabled"),o),W(a,"".concat(l,"-vertical"),c),a),O),ref:$}),s.createElement("div",{className:"".concat(l,"-group")},s.createElement(nt,{vertical:c,prefixCls:l,value:S,containerRef:D,motionName:"".concat(l,"-").concat(h),direction:u,getValueIndex:function(R){return w.findIndex(function(U){return U.value===R})},onMotionStart:function(){j(!0)},onMotionEnd:function(){j(!1)}}),w.map(function(I){var R;return s.createElement(rt,le({},I,{name:_,key:I.value,prefixCls:l,className:J(I.className,"".concat(l,"-item"),(R={},W(R,"".concat(l,"-item-selected"),I.value===S&&!X),W(R,"".concat(l,"-item-focused"),Ie&&Z&&I.value===S),R)),checked:I.value===S,onChange:H,onFocus:Ce,onBlur:$e,onKeyDown:Me,onKeyUp:Re,onMouseDown:De,disabled:!!o||!!I.disabled}))})))}),ot=lt;function ue(t,e){return{[`${t}, ${t}:hover, ${t}:focus`]:{color:e.colorTextDisabled,cursor:"not-allowed"}}}function he(t){return{backgroundColor:t.itemSelectedBg,boxShadow:t.boxShadowTertiary}}const dt=Object.assign({overflow:"hidden"},Be),ct=t=>{const{componentCls:e}=t,i=t.calc(t.controlHeight).sub(t.calc(t.trackPadding).mul(2)).equal(),a=t.calc(t.controlHeightLG).sub(t.calc(t.trackPadding).mul(2)).equal(),r=t.calc(t.controlHeightSM).sub(t.calc(t.trackPadding).mul(2)).equal();return{[e]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ae(t)),{display:"inline-block",padding:t.trackPadding,color:t.itemColor,background:t.trackBg,borderRadius:t.borderRadius,transition:`all ${t.motionDurationMid} ${t.motionEaseInOut}`}),Ve(t)),{[`${e}-group`]:{position:"relative",display:"flex",alignItems:"stretch",justifyItems:"flex-start",flexDirection:"row",width:"100%"},[`&${e}-rtl`]:{direction:"rtl"},[`&${e}-vertical`]:{[`${e}-group`]:{flexDirection:"column"},[`${e}-thumb`]:{width:"100%",height:0,padding:`0 ${z(t.paddingXXS)}`}},[`&${e}-block`]:{display:"flex"},[`&${e}-block ${e}-item`]:{flex:1,minWidth:0},[`${e}-item`]:{position:"relative",textAlign:"center",cursor:"pointer",transition:`color ${t.motionDurationMid} ${t.motionEaseInOut}`,borderRadius:t.borderRadiusSM,transform:"translateZ(0)","&-selected":Object.assign(Object.assign({},he(t)),{color:t.itemSelectedColor}),"&-focused":Object.assign({},Le(t)),"&::after":{content:'""',position:"absolute",zIndex:-1,width:"100%",height:"100%",top:0,insetInlineStart:0,borderRadius:"inherit",opacity:0,transition:`opacity ${t.motionDurationMid}`,pointerEvents:"none"},[`&:hover:not(${e}-item-selected):not(${e}-item-disabled)`]:{color:t.itemHoverColor,"&::after":{opacity:1,backgroundColor:t.itemHoverBg}},[`&:active:not(${e}-item-selected):not(${e}-item-disabled)`]:{color:t.itemHoverColor,"&::after":{opacity:1,backgroundColor:t.itemActiveBg}},"&-label":Object.assign({minHeight:i,lineHeight:z(i),padding:`0 ${z(t.segmentedPaddingHorizontal)}`},dt),"&-icon + *":{marginInlineStart:t.calc(t.marginSM).div(2).equal()},"&-input":{position:"absolute",insetBlockStart:0,insetInlineStart:0,width:0,height:0,opacity:0,pointerEvents:"none"}},[`${e}-thumb`]:Object.assign(Object.assign({},he(t)),{position:"absolute",insetBlockStart:0,insetInlineStart:0,width:0,height:"100%",padding:`${z(t.paddingXXS)} 0`,borderRadius:t.borderRadiusSM,transition:`transform ${t.motionDurationSlow} ${t.motionEaseInOut}, height ${t.motionDurationSlow} ${t.motionEaseInOut}`,[`& ~ ${e}-item:not(${e}-item-selected):not(${e}-item-disabled)::after`]:{backgroundColor:"transparent"}}),[`&${e}-lg`]:{borderRadius:t.borderRadiusLG,[`${e}-item-label`]:{minHeight:a,lineHeight:z(a),padding:`0 ${z(t.segmentedPaddingHorizontal)}`,fontSize:t.fontSizeLG},[`${e}-item, ${e}-thumb`]:{borderRadius:t.borderRadius}},[`&${e}-sm`]:{borderRadius:t.borderRadiusSM,[`${e}-item-label`]:{minHeight:r,lineHeight:z(r),padding:`0 ${z(t.segmentedPaddingHorizontalSM)}`},[`${e}-item, ${e}-thumb`]:{borderRadius:t.borderRadiusXS}}}),ue(`&-disabled ${e}-item`,t)),ue(`${e}-item-disabled`,t)),{[`${e}-thumb-motion-appear-active`]:{transition:`transform ${t.motionDurationSlow} ${t.motionEaseInOut}, width ${t.motionDurationSlow} ${t.motionEaseInOut}`,willChange:"transform, width"},[`&${e}-shape-round`]:{borderRadius:9999,[`${e}-item, ${e}-thumb`]:{borderRadius:9999}}})}},ut=t=>{const{colorTextLabel:e,colorText:i,colorFillSecondary:a,colorBgElevated:r,colorFill:l,lineWidthBold:u,colorBgLayout:c}=t;return{trackPadding:u,trackBg:c,itemColor:e,itemHoverColor:i,itemHoverBg:a,itemSelectedBg:r,itemActiveBg:l,itemSelectedColor:i}},ht=ze("Segmented",t=>{const{lineWidth:e,calc:i}=t,a=ke(t,{segmentedPaddingHorizontal:i(t.controlPaddingHorizontal).sub(e).equal(),segmentedPaddingHorizontalSM:i(t.controlPaddingHorizontalSM).sub(e).equal()});return[ct(a)]},ut);var me=function(t,e){var i={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(i[a]=t[a]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,a=Object.getOwnPropertySymbols(t);r<a.length;r++)e.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(t,a[r])&&(i[a[r]]=t[a[r]]);return i};function mt(t){return typeof t=="object"&&!!(t!=null&&t.icon)}const yt=s.forwardRef((t,e)=>{const i=Ke(),{prefixCls:a,className:r,rootClassName:l,block:u,options:c=[],size:m="middle",style:y,vertical:o,shape:d="default",name:x=i}=t,_=me(t,["prefixCls","className","rootClassName","block","options","size","style","vertical","shape","name"]),{getPrefixCls:p,direction:M,className:O,style:g}=Ue("segmented"),h=p("segmented",a),[b,D,$]=ht(h),w=We(m),v=s.useMemo(()=>c.map(f=>{if(mt(f)){const{icon:G,label:A}=f,X=me(f,["icon","label"]);return Object.assign(Object.assign({},X),{label:s.createElement(s.Fragment,null,s.createElement("span",{className:`${h}-item-icon`},G),A&&s.createElement("span",null,A))})}return f}),[c,h]),F=J(r,l,O,{[`${h}-block`]:u,[`${h}-sm`]:w==="small",[`${h}-lg`]:w==="large",[`${h}-vertical`]:o,[`${h}-shape-${d}`]:d==="round"},D,$),S=Object.assign(Object.assign({},g),y);return b(s.createElement(ot,Object.assign({},_,{name:x,className:F,style:S,options:v,ref:e,prefixCls:h,direction:M,vertical:o})))}),gt=yt,{Option:Ht}=K,ft=({})=>{const[t,e]=s.useState("study"),[i,a]=s.useState("disease"),r=C.useFormInstance(),[l,u]=s.useState([]),[c,m]=s.useState([]),{modals:y,openModals:o,closeModals:d}=fe(["entityDrawer","studyDrawer"]),[x,_]=s.useState();return n.jsxs(n.Fragment,{children:[n.jsx(C.Item,{label:"Study",name:"study_id",children:n.jsx(q,{placeholder:"which study or reference provides evidence",style:{cursor:"pointer"},onClick:()=>o("studyDrawer",{name:"study_id"})})}),n.jsx(C.Item,{label:"Subject",name:"subject_id",children:n.jsx(q,{placeholder:"who does something",style:{cursor:"pointer"},onClick:()=>o("entityDrawer",{name:"subject_id"})})}),n.jsx(C.Item,{label:"Object",name:"object_id",children:n.jsx(q,{placeholder:"who receives the effect",style:{cursor:"pointer"},onClick:()=>o("entityDrawer",{name:"object_id"})})}),n.jsx(C.Item,{label:"Predicate",name:"predicate",children:n.jsx(K,{allowClear:!0,options:[{value:"CORRELATED_WITH",label:"CORRELATED_WITH"},{value:"PRODUCES",label:"PRODUCES"},{value:"MODULATES",label:"MODULATES"},{value:"ACTIVATES",label:"ACTIVATES"},{value:"INHIBITS",label:"INHIBITS"}]})}),n.jsx(C.Item,{label:"effect",name:"effect",children:n.jsx(K,{allowClear:!0,options:[{value:"Up",label:"Up"},{value:"Down",label:"Down"}]})}),n.jsx(C.Item,{label:"Observed",name:"observed_id",children:n.jsx(q,{placeholder:"where the phenomenon is observed (e.g., patient group, tissue, condition)",style:{cursor:"pointer"},onClick:()=>o("entityDrawer",{name:"observed_id"})})}),n.jsx(vt,{form:r,setRecord:_,visible:y.entityDrawer.visible,params:y.entityDrawer.params,onClose:()=>d("entityDrawer")}),n.jsx(bt,{form:r,setRecord:_,visible:y.studyDrawer.visible,params:y.studyDrawer.params,onClose:()=>d("studyDrawer")})]})},bt=({visible:t,setRecord:e,form:i,params:a,onClose:r,callback:l})=>n.jsx(n.Fragment,{children:n.jsx(te,{open:t,onClose:r,width:"80%",children:t&&n.jsx(Ye,{rowSelection:{onChange:(u,c)=>{i.setFieldValue(a.name,c[0].entity_id),r()},type:"radio"}})})}),vt=({visible:t,setRecord:e,form:i,params:a,onClose:r,callback:l})=>n.jsx(n.Fragment,{children:n.jsx(te,{open:t,onClose:r,width:"80%",children:t&&n.jsx(Se,{disableWidth:!0,rowSelection:{onChange:(u,c)=>{i.setFieldValue(a.name,c[0].entity_id),r()},type:"radio"}})})}),xt=()=>n.jsxs(n.Fragment,{children:[n.jsx(C.Item,{label:"entity_name_zh",name:"entity_name_zh",children:n.jsx(q,{})}),n.jsx(C.Item,{label:"entity_type",name:"entity_type",rules:[{required:!0,message:"该字段不能为空!"}],children:n.jsx(K,{allowClear:!0,options:[{value:"Microbe",label:"Microbe"},{value:"Disease",label:"Disease"},{value:"Pathway",label:"Pathway"},{value:"Pathway",label:"Pathway"},{value:"Compound",label:"compound"},{value:"evidence",label:"Evidence"}]})}),n.jsx(C.Item,{name:"tags",label:"tags",children:n.jsx(K,{mode:"tags",style:{width:"100%"}})}),n.jsx(C.Item,{name:"short_name",label:"short_name",children:n.jsx(K,{mode:"tags",style:{width:"100%"}})})]}),_e=({visible:t,params:e,onClose:i,record:a,callback:r,children:l,entityType:u="mesh"})=>{const[c]=C.useForm(),{messageApi:m}=qe(),[y,o]=s.useState(!1);s.useEffect(()=>{t&&(e!=null&&e.entityId)?d():c.resetFields()},[t]);const d=async()=>{o(!0);const _=await k.get(`/entity/get/${u}/${e.entityId}`);c.setFieldsValue(_.data),o(!1)},x=async()=>{const _=await c.validateFields();o(!0);try{e!=null&&e.entityId?await k.put(`/entity/update/${e.entityType}/${e.entityId}`,_):await k.post(`/entity/add/${e.entityType}`,_)}catch{o(!1),m.error("error!")}o(!1),i(),r&&r(),m.success("操作成功!")};return n.jsx(be,{loading:y,title:e!=null&&e.entityId?"update entity":"create entity",onOk:x,width:"50%",open:t,onClose:i,onCancel:i,children:n.jsxs(C,{form:c,children:[l,n.jsx(Ge,{ghost:!0,items:[{key:"1",label:"more",children:n.jsx(n.Fragment,{children:n.jsx(C.Item,{noStyle:!0,shouldUpdate:!0,children:()=>n.jsx(Xe,{children:n.jsx("pre",{children:JSON.stringify(c.getFieldsValue(),null,2)})})})})}]})]})})},_t={mesh:xt},pt=({type:t,record:e})=>{const i=_t[t]||(()=>n.jsxs("div",{children:["no ",t," component!"]}));return n.jsx(i,{record:e})},jt=({...t})=>{const{params:e,record:i}=t,[a,r]=s.useState([]);return s.useEffect(()=>{if(r([]),e!=null&&e.category&&Array.isArray(e==null?void 0:e.category)){const l=e==null?void 0:e.category.map(u=>({label:u,value:u}));r(l)}},[e]),n.jsx(n.Fragment,{children:n.jsxs(_e,{...t,children:[!(e!=null&&e.entityId)&&n.jsx(C.Item,{label:"category",name:"category",rules:[{required:!0,message:"该字段不能为空!"}],children:n.jsx(K,{options:a})}),n.jsx(C.Item,{label:"is_research",name:"is_research",children:n.jsx(tt,{})}),n.jsx(C.Item,{label:"entity_name",name:"entity_name",rules:[{required:!0,message:"该字段不能为空!"}],children:n.jsx(q,{})}),n.jsx(pt,{type:e==null?void 0:e.entityType,record:i})]})})},zt=({...t})=>n.jsx(n.Fragment,{children:n.jsx(_e,{...t,entityType:"association",children:n.jsx(ft,{})})}),pe=(t,e,i)=>t.map(a=>a.key===e?{...a,children:i}:a.children?{...a,children:pe(a.children,e,i)}:a),St=s.forwardRef(({entityType:t,params:e},i)=>{const[a,r]=s.useState(),[l,u]=s.useState(new Set),[c,m]=s.useState(),[y,o]=s.useState("default"),d=async(h,b,D,$="")=>{const w=await k.post(`/entity/page/${t}`,{page_number:b,page_size:D,parent_id:String(h),keyword:$,...e}),{items:v,total:F}=w.data;if(t=="taxonomy"){const S=v.map(f=>({title:n.jsx(n.Fragment,{children:n.jsxs(N,{title:`${f.entity_name}(${f.rank})(${f.tax_id})`,children:[f.entity_name," (",f.rank,")"]})}),key:f.tax_id,isLeaf:!f.has_children}));return m(S),{children:S,total:F}}else if(t=="mesh"){const S=v.map(f=>({title:n.jsx(n.Fragment,{children:n.jsxs(N,{title:`${f.entity_name}`,children:[f.entity_name,"(",f.entity_id,")"]})}),key:f.tree_number,isLeaf:!f.has_children}));return m(S),{children:S,total:F}}else{const S=v.map(f=>({title:n.jsx(n.Fragment,{children:n.jsx(N,{title:`${f.entity_name}`,children:f.entity_name})}),key:f.entity_id,isLeaf:!f.has_children}));return m(S),{children:S,total:F}}},x=async()=>{const{children:h}=await d(y,1,-1);r(h)};s.useImperativeHandle(i,()=>({reload:x})),s.useEffect(()=>{x()},[t,JSON.stringify(e)]);const _=async({key:h,children:b})=>{if(b)return;u($=>new Set($).add(h));const{children:D}=await d(h,1,-1);r($=>pe($,h,[...D])),u($=>{const w=new Set($);return w.delete(h),w})},p=s.useRef(null),[M,O]=s.useState(null),g=()=>{if(p.current){const h=p.current.getBoundingClientRect().top;O(window.innerHeight-h)}};return s.useEffect(()=>(g(),window.addEventListener("resize",g),()=>{window.removeEventListener("resize",g)}),[]),n.jsx("div",{ref:p,children:a?n.jsx(n.Fragment,{children:n.jsx(xe,{height:M,loadData:_,treeData:a,showLine:!0,titleRender:h=>l.has(Number(h.key))?n.jsx(Qe,{size:"small"}):h.title})}):n.jsx(ve,{active:!0})})}),wt=t=>{let e=[];switch(t){case"organisms":e=[...e,{title:"entity_id",dataIndex:"entity_id",key:"taxonomy_id",render:(i,a)=>n.jsx("a",{href:`https://meshb.nlm.nih.gov/record/ui?ui=${i}`,target:"_blank",children:i})},{title:"entity_name",dataIndex:"entity_name",key:"entity_name",render:(i,a)=>n.jsx(n.Fragment,{children:a!=null&&a.entity_name_en?n.jsx(N,{title:a==null?void 0:a.entity_name_en,children:i}):n.jsx(n.Fragment,{children:i})})},{title:"taxonomy_name",dataIndex:"taxonomy_name",key:"taxonomy_name"},{title:"rank",dataIndex:"rank",key:"rank"},{title:"tax_id",dataIndex:"tax_id",key:"tax_id"},{title:"entity_type",dataIndex:"entity_type",key:"entity_type"},{title:"has_children",dataIndex:"has_children",key:"has_children",render:(i,a)=>i?"exist":"non-existent"},{title:"is_exist_graph",dataIndex:"is_exist_graph",key:"is_exist_graph",render:(i,a)=>i?"exist":"non-existent"}];break;case"mesh":e=[...e,{title:"entity_id",dataIndex:"entity_id",key:"taxonomy_id",render:(i,a)=>n.jsx("a",{href:`https://meshb.nlm.nih.gov/record/ui?ui=${i}`,target:"_blank",children:i})},{title:"entity_name",dataIndex:"entity_name",key:"entity_name",render:(i,a)=>n.jsx(n.Fragment,{children:a!=null&&a.entity_name_en?n.jsx(N,{title:a==null?void 0:a.entity_name_en,children:i}):n.jsx(n.Fragment,{children:i})})},{title:"short_name",dataIndex:"short_name",key:"short_name",render:(i,a)=>n.jsx(n.Fragment,{children:i&&Array.isArray(i)&&i.map((r,l)=>n.jsx(de,{children:r},l))})},{title:"entity_type",dataIndex:"entity_type",key:"entity_type"},{title:"has_children",dataIndex:"has_children",key:"has_children",render:(i,a)=>i?"exist":"non-existent"},{title:"is_exist_graph",dataIndex:"is_exist_graph",key:"is_exist_graph",render:(i,a)=>i?"exist":"non-existent"},{title:"is_research",dataIndex:"is_research",key:"is_research",render:(i,a)=>i?"research":"non-research"},{title:"tags",dataIndex:"tags",key:"tags",render:(i,a)=>n.jsx(n.Fragment,{children:i&&Array.isArray(i)&&i.map((r,l)=>n.jsx(de,{children:r},l))})}];break;case"association":e=[{title:"entity_id",dataIndex:"entity_id",key:"entity_id"},{title:"subject_name",dataIndex:"subject_name",key:"subject_name",render:(i,a)=>n.jsx(n.Fragment,{children:n.jsx(N,{title:a==null?void 0:a.subject_id,children:i})})},{title:"predicate",dataIndex:"predicate",key:"predicate"},{title:"object_name",dataIndex:"object_name",key:"object_name",render:(i,a)=>n.jsx(n.Fragment,{children:n.jsx(N,{title:a==null?void 0:a.object_id,children:i})})},{title:"effect",dataIndex:"effect",key:"effect"},{title:"study_name",dataIndex:"study_name",key:"study_name",render:(i,a)=>n.jsx(n.Fragment,{children:n.jsx(N,{title:a==null?void 0:a.study_id,children:i})})},{title:"observed_name",dataIndex:"observed_name",key:"observed_name",render:(i,a)=>n.jsx(n.Fragment,{children:n.jsx(N,{title:a==null?void 0:a.observed_id,children:i})})},{title:"created_at",dataIndex:"created_at",key:"created_at"}];break;default:e=[{title:"entity_id",dataIndex:"entity_id",key:"taxonomy_id"},{title:"entity_name",dataIndex:"entity_name",key:"entity_name"},{title:"has_children",dataIndex:"has_children",key:"has_children",render:(i,a)=>i?"exist":"non-existent"},{title:"is_exist_graph",dataIndex:"is_exist_graph",key:"is_exist_graph",render:(i,a)=>i?"exist":"non-existent"},{title:"is_research",dataIndex:"is_research",key:"is_research",render:(i,a)=>i?"research":"non-research"}]}return e},It=(t,e,i,a)=>{let r=[];switch(t){case"association":r=[{title:"操作",key:"action",fixed:"right",width:200,render:(l,u)=>n.jsx(oe,{size:"middle",children:e&&n.jsxs(n.Fragment,{children:[n.jsx(L,{size:"small",color:"cyan",variant:"solid",onClick:()=>{console.log("update:",u),e("optModal",{entityType:t,entityId:u.entity_id})},children:"update"}),n.jsx(ee,{title:"Confirm deletion?",onConfirm:async()=>{var c,m,y,o;try{await k.delete(`/entity-relation/delete-association/${u.entity_id}`),a.success("Delete successfully!"),i()}catch(d){console.log((m=(c=d==null?void 0:d.response)==null?void 0:c.data)==null?void 0:m.detail),a.error((o=(y=d==null?void 0:d.response)==null?void 0:y.data)==null?void 0:o.detail)}},children:n.jsx(L,{size:"small",danger:!0,variant:"solid",children:"delete"})})]})})}];break;case"mesh":r=[{title:"操作",key:"action",fixed:"right",width:200,render:(l,u)=>n.jsx(oe,{size:"middle",children:e&&n.jsxs(n.Fragment,{children:[n.jsx(L,{size:"small",color:"cyan",variant:"solid",onClick:()=>{e("entityDetailsModal",{entityType:t,entityId:u.entity_id})},children:"details"}),n.jsx(L,{size:"small",color:"cyan",variant:"solid",onClick:()=>{console.log("update:",u),e("optModal",{entityType:t,entityId:u.entity_id})},children:"update"}),u.is_exist_graph?n.jsxs(n.Fragment,{children:[n.jsx(L,{size:"small",color:"cyan",variant:"solid",onClick:()=>{e("graphView",{entityType:t,entityId:u.entity_id,entityName:u.entity_name})},children:"network"}),n.jsx(ee,{title:"确认删除节点?",onConfirm:async()=>{var c,m,y,o;try{await k.delete(`/entity/delete-node/${t}/${u.entity_id}`),a.success("删除成功!"),i()}catch(d){console.log((m=(c=d==null?void 0:d.response)==null?void 0:c.data)==null?void 0:m.detail),a.error((o=(y=d==null?void 0:d.response)==null?void 0:y.data)==null?void 0:o.detail)}},children:n.jsx(L,{size:"small",danger:!0,variant:"solid",children:"delete"})})]}):n.jsx(ee,{title:"Confirm deletion?",onConfirm:async()=>{var c,m,y,o;try{await k.delete(`/entity/delete/${t}/${u.entity_id}`),a.success("Delete successfully!"),i()}catch(d){console.log((m=(c=d==null?void 0:d.response)==null?void 0:c.data)==null?void 0:m.detail),a.error((o=(y=d==null?void 0:d.response)==null?void 0:y.data)==null?void 0:o.detail)}},children:n.jsx(L,{size:"small",danger:!0,variant:"solid",children:"delete"})})]})})}];break}return r},Ct=s.lazy(()=>Je(()=>import("./graph-view-BUJAksbS.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url)),je=s.forwardRef(({openModals:t,rowSelection:e,disableWidth:i=!1},a)=>{const[r,l]=s.useState("mesh"),[u,c]=s.useState({category:["F03","C10","F01"]}),[m,y]=s.useState("mental_disorders"),o=s.useRef(null),[d,x]=s.useState("table"),_=()=>{var g;(g=o.current)==null||g.reload()},p=g=>{var h;o.current&&((h=o.current)==null||h.setPageNumber(g))},M=[{key:"mental_disorders",label:"Mental Disorders"},{key:"organisms",label:"Microbe"},{key:"mesh-KEGG",label:"KEGG"},{key:"chemicals_and_drugs",label:"Chemicals and Drugs"}],O=g=>{if(g.startsWith("mesh")){const h=g.split("-")[1];c({category:[h]}),l("mesh")}else g=="organisms"?(l("organisms"),c({category:["B02","B03","B04"],registry_join:"taxonomy"})):g=="mental_disorders"?(c({category:["F03","C10","F01"]}),l("mesh")):g=="chemicals_and_drugs"?(c({category:["D01","D02","D03","D04","D05","D06","D08","D09","D10","D12","D13","D20","D23","D25","D26","D27"]}),l("mesh")):g=="evidence"&&(c({category:["evidence"],registry_join:"study"}),l("mesh"))};return s.useImperativeHandle(a,()=>({reload:_})),n.jsxs("div",{style:i?{}:{maxWidth:"1500px",margin:"1rem auto"},children:[n.jsx("div",{style:{marginBottom:"1rem"},children:" "}),n.jsx(et,{size:"small",activeKey:m,onChange:g=>{O(g),y(g),p(1)},tabBarExtraContent:n.jsx(n.Fragment,{children:n.jsx(gt,{size:"small",value:d,onChange:g=>x(g),options:[{label:"table",value:"table"},{label:"tree",value:"tree"}]})}),items:M}),d=="table"&&n.jsx(n.Fragment,{children:n.jsx(Ze,{columns:({openModal:g,reload:h,messageApi:b})=>{const D=wt(r),$=It("mesh",g,h,b);return[...D,...$]},rowSelection:e,ref:o,openModal:t,params:u,api:"/entity/page/mesh"})}),d=="tree"&&n.jsx(n.Fragment,{children:n.jsx(St,{ref:o,entityType:"mesh",params:u})})]})}),Se=({...t})=>{const{modals:e,openModals:i,closeModals:a}=fe(["entityPage","optModal","graphView","entityDrawer","entityDetailsModal"]),r=s.useRef(null),l=()=>{var u;(u=r.current)==null||u.reload()};return n.jsxs(n.Fragment,{children:[n.jsx(je,{...t,ref:r,openModals:i}),n.jsx(jt,{openModals:i,callback:l,visible:e.optModal.visible,params:e.optModal.params,onClose:()=>a("optModal")}),n.jsx($t,{callback:l,visible:e.graphView.visible,params:e.graphView.params,onClose:()=>a("graphView")}),n.jsx(Dt,{openModals:i,callback:l,visible:e.entityDetailsModal.visible,params:e.entityDetailsModal.params,onClose:()=>a("entityDetailsModal")})]})},$t=({visible:t,params:e,onClose:i,callback:a})=>n.jsx(be,{title:e==null?void 0:e.entityName,width:"60%",footer:null,open:t,onClose:i,onCancel:i,children:n.jsx(s.Suspense,{fallback:n.jsx(ve,{active:!0}),children:n.jsx(Ct,{entity_id:e==null?void 0:e.entityId})})}),Dt=({visible:t,params:e,onClose:i})=>{const[a,r]=s.useState(!1),[l,u]=s.useState(),[c,m]=s.useState(),y=d=>d.map(x=>({title:x.entity_name,key:x.entity_id,children:x.children?y(x.children):[]})),o=async()=>{r(!0);const d=await k.get(`/entity/get/${e.entityType}/${e.entityId}`),x=y(d.data.parents);m(x),r(!1)};return s.useEffect(()=>{e!=null&&e.entityId&&o()},[e==null?void 0:e.entityId]),n.jsx(te,{open:t,onClose:i,width:"40%",loading:a,children:c&&n.jsx(n.Fragment,{children:n.jsx(xe,{treeData:c,defaultExpandAll:!0,showLine:!0,selectable:!0})})})},kt=Object.freeze(Object.defineProperty({__proto__:null,EntityView:je,default:Se},Symbol.toStringTag,{value:"Module"}));export{zt as A,It as a,wt as g,kt as i};
