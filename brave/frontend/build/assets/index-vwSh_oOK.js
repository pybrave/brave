const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./graph-view-CFPtosdp.js","./main-BFdXSxSk.js","./main-DLoYsyAm.css","./index-Bu_8sAQb.js","./index-u54hlnBP.js","./Dropdown-CjWuFlcv.js","./index-CrFRXVOt.js","./index-B8u-5pkT.js","./Table-CAzGvc6L.js","./addEventListener-CGGMUWeS.js","./NodeIndexOutlined-BHG9c7QD.js","./index-KokPGa7l.js","./usePagination-D-1FogKP.js","./index-U2Qux_ly.js"])))=>i.map(i=>d[i]);
import{r as s,v as ge,_ as Z,ad as K,aN as Ne,aj as ke,ac as Q,O as J,ak as ye,ag as He,ax as Ae,aO as Ve,ae as q,aw as fe,Z as Le,$ as Be,a0 as Ke,a2 as Ue,a1 as k,aP as We,aC as qe,aQ as Ge,a5 as Xe,a6 as Je,aR as Ye,f as Ze,d as ve,j as n,g as Y,S as H,I as U,o as P,aq as Qe,F as $,q as be,a as A,M as xe,i as et,c as tt,t as _e,B,P as ne,aL as nt}from"./main-BFdXSxSk.js";import{u as at}from"./usePagination-D-1FogKP.js";import{F as it,T as je,S as oe}from"./Table-CAzGvc6L.js";import{P as st,S as lt}from"./index-CrFRXVOt.js";import{S as pe}from"./index-U2Qux_ly.js";import{T as ce}from"./index-B8u-5pkT.js";import{T as rt}from"./index-u54hlnBP.js";import{D as Se}from"./index-KokPGa7l.js";var ot={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"},ct=function(e,i){return s.createElement(ge,Z({},e,{ref:i,icon:ot}))},dt=s.forwardRef(ct),ut={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"}}]},name:"redo",theme:"outlined"},ht=function(e,i){return s.createElement(ge,Z({},e,{ref:i,icon:ut}))},mt=s.forwardRef(ht),de=function(e,i){if(!e)return null;var a={left:e.offsetLeft,right:e.parentElement.clientWidth-e.clientWidth-e.offsetLeft,width:e.clientWidth,top:e.offsetTop,bottom:e.parentElement.clientHeight-e.clientHeight-e.offsetTop,height:e.clientHeight};return i?{left:0,right:0,width:0,top:a.top,bottom:a.bottom,height:a.height}:{left:a.left,right:a.right,width:a.width,top:0,bottom:0,height:0}},E=function(e){return e!==void 0?"".concat(e,"px"):void 0};function gt(t){var e=t.prefixCls,i=t.containerRef,a=t.value,l=t.getValueIndex,o=t.motionName,d=t.onMotionStart,u=t.onMotionEnd,m=t.direction,y=t.vertical,r=y===void 0?!1:y,c=s.useRef(null),x=s.useState(a),j=K(x,2),_=j[0],O=j[1],D=function(N){var z,L=l(N),T=(z=i.current)===null||z===void 0?void 0:z.querySelectorAll(".".concat(e,"-item"))[L];return(T==null?void 0:T.offsetParent)&&T},g=s.useState(null),h=K(g,2),v=h[0],R=h[1],C=s.useState(null),S=K(C,2),f=S[0],F=S[1];Ne(function(){if(_!==a){var p=D(_),N=D(a),z=de(p,r),L=de(N,r);O(a),R(z),F(L),p&&N?d():u()}},[a]);var w=s.useMemo(function(){if(r){var p;return E((p=v==null?void 0:v.top)!==null&&p!==void 0?p:0)}return E(m==="rtl"?-(v==null?void 0:v.right):v==null?void 0:v.left)},[r,m,v]),b=s.useMemo(function(){if(r){var p;return E((p=f==null?void 0:f.top)!==null&&p!==void 0?p:0)}return E(m==="rtl"?-(f==null?void 0:f.right):f==null?void 0:f.left)},[r,m,f]),G=function(){return r?{transform:"translateY(var(--thumb-start-top))",height:"var(--thumb-start-height)"}:{transform:"translateX(var(--thumb-start-left))",width:"var(--thumb-start-width)"}},V=function(){return r?{transform:"translateY(var(--thumb-active-top))",height:"var(--thumb-active-height)"}:{transform:"translateX(var(--thumb-active-left))",width:"var(--thumb-active-width)"}},X=function(){R(null),F(null),u()};return!v||!f?null:s.createElement(ke,{visible:!0,motionName:o,motionAppear:!0,onAppearStart:G,onAppearActive:V,onVisibleChanged:X},function(p,N){var z=p.className,L=p.style,T=Q(Q({},L),{},{"--thumb-start-left":w,"--thumb-start-width":E(v==null?void 0:v.width),"--thumb-active-left":b,"--thumb-active-width":E(f==null?void 0:f.width),"--thumb-start-top":w,"--thumb-start-height":E(v==null?void 0:v.height),"--thumb-active-top":b,"--thumb-active-height":E(f==null?void 0:f.height)}),ee={ref:ye(c,N),style:T,className:J("".concat(e,"-thumb"),z)};return s.createElement("div",ee)})}var yt=["prefixCls","direction","vertical","options","disabled","defaultValue","value","name","onChange","className","motionName"];function ft(t){if(typeof t.title<"u")return t.title;if(fe(t.label)!=="object"){var e;return(e=t.label)===null||e===void 0?void 0:e.toString()}}function vt(t){return t.map(function(e){if(fe(e)==="object"&&e!==null){var i=ft(e);return Q(Q({},e),{},{title:i})}return{label:e==null?void 0:e.toString(),title:e==null?void 0:e.toString(),value:e}})}var bt=function(e){var i=e.prefixCls,a=e.className,l=e.disabled,o=e.checked,d=e.label,u=e.title,m=e.value,y=e.name,r=e.onChange,c=e.onFocus,x=e.onBlur,j=e.onKeyDown,_=e.onKeyUp,O=e.onMouseDown,D=function(h){l||r(h,m)};return s.createElement("label",{className:J(a,q({},"".concat(i,"-item-disabled"),l)),onMouseDown:O},s.createElement("input",{name:y,className:"".concat(i,"-item-input"),type:"radio",disabled:l,checked:o,onChange:D,onFocus:c,onBlur:x,onKeyDown:j,onKeyUp:_}),s.createElement("div",{className:"".concat(i,"-item-label"),title:u,"aria-selected":o},d))},xt=s.forwardRef(function(t,e){var i,a,l=t.prefixCls,o=l===void 0?"rc-segmented":l,d=t.direction,u=t.vertical,m=t.options,y=m===void 0?[]:m,r=t.disabled,c=t.defaultValue,x=t.value,j=t.name,_=t.onChange,O=t.className,D=O===void 0?"":O,g=t.motionName,h=g===void 0?"thumb-motion":g,v=He(t,yt),R=s.useRef(null),C=s.useMemo(function(){return ye(R,e)},[R,e]),S=s.useMemo(function(){return vt(y)},[y]),f=Ae((i=S[0])===null||i===void 0?void 0:i.value,{value:x,defaultValue:c}),F=K(f,2),w=F[0],b=F[1],G=s.useState(!1),V=K(G,2),X=V[0],p=V[1],N=function(M,W){b(W),_==null||_(W)},z=Ve(v,["children"]),L=s.useState(!1),T=K(L,2),ee=T[0],ae=T[1],De=s.useState(!1),ie=K(De,2),Re=ie[0],se=ie[1],Oe=function(){se(!0)},Me=function(){se(!1)},Fe=function(){ae(!1)},Pe=function(M){M.key==="Tab"&&ae(!0)},le=function(M){var W=S.findIndex(function(Te){return Te.value===w}),re=S.length,ze=(W+M+re)%re,te=S[ze];te&&(b(te.value),_==null||_(te.value))},Ee=function(M){switch(M.key){case"ArrowLeft":case"ArrowUp":le(-1);break;case"ArrowRight":case"ArrowDown":le(1);break}};return s.createElement("div",Z({role:"radiogroup","aria-label":"segmented control",tabIndex:r?void 0:0},z,{className:J(o,(a={},q(a,"".concat(o,"-rtl"),d==="rtl"),q(a,"".concat(o,"-disabled"),r),q(a,"".concat(o,"-vertical"),u),a),D),ref:C}),s.createElement("div",{className:"".concat(o,"-group")},s.createElement(gt,{vertical:u,prefixCls:o,value:w,containerRef:R,motionName:"".concat(o,"-").concat(h),direction:d,getValueIndex:function(M){return S.findIndex(function(W){return W.value===M})},onMotionStart:function(){p(!0)},onMotionEnd:function(){p(!1)}}),S.map(function(I){var M;return s.createElement(bt,Z({},I,{name:j,key:I.value,prefixCls:o,className:J(I.className,"".concat(o,"-item"),(M={},q(M,"".concat(o,"-item-selected"),I.value===w&&!X),q(M,"".concat(o,"-item-focused"),Re&&ee&&I.value===w),M)),checked:I.value===w,onChange:N,onFocus:Oe,onBlur:Me,onKeyDown:Ee,onKeyUp:Pe,onMouseDown:Fe,disabled:!!r||!!I.disabled}))})))}),_t=xt;function ue(t,e){return{[`${t}, ${t}:hover, ${t}:focus`]:{color:e.colorTextDisabled,cursor:"not-allowed"}}}function he(t){return{backgroundColor:t.itemSelectedBg,boxShadow:t.boxShadowTertiary}}const jt=Object.assign({overflow:"hidden"},qe),pt=t=>{const{componentCls:e}=t,i=t.calc(t.controlHeight).sub(t.calc(t.trackPadding).mul(2)).equal(),a=t.calc(t.controlHeightLG).sub(t.calc(t.trackPadding).mul(2)).equal(),l=t.calc(t.controlHeightSM).sub(t.calc(t.trackPadding).mul(2)).equal();return{[e]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ke(t)),{display:"inline-block",padding:t.trackPadding,color:t.itemColor,background:t.trackBg,borderRadius:t.borderRadius,transition:`all ${t.motionDurationMid} ${t.motionEaseInOut}`}),Ue(t)),{[`${e}-group`]:{position:"relative",display:"flex",alignItems:"stretch",justifyItems:"flex-start",flexDirection:"row",width:"100%"},[`&${e}-rtl`]:{direction:"rtl"},[`&${e}-vertical`]:{[`${e}-group`]:{flexDirection:"column"},[`${e}-thumb`]:{width:"100%",height:0,padding:`0 ${k(t.paddingXXS)}`}},[`&${e}-block`]:{display:"flex"},[`&${e}-block ${e}-item`]:{flex:1,minWidth:0},[`${e}-item`]:{position:"relative",textAlign:"center",cursor:"pointer",transition:`color ${t.motionDurationMid} ${t.motionEaseInOut}`,borderRadius:t.borderRadiusSM,transform:"translateZ(0)","&-selected":Object.assign(Object.assign({},he(t)),{color:t.itemSelectedColor}),"&-focused":Object.assign({},We(t)),"&::after":{content:'""',position:"absolute",zIndex:-1,width:"100%",height:"100%",top:0,insetInlineStart:0,borderRadius:"inherit",opacity:0,transition:`opacity ${t.motionDurationMid}`,pointerEvents:"none"},[`&:hover:not(${e}-item-selected):not(${e}-item-disabled)`]:{color:t.itemHoverColor,"&::after":{opacity:1,backgroundColor:t.itemHoverBg}},[`&:active:not(${e}-item-selected):not(${e}-item-disabled)`]:{color:t.itemHoverColor,"&::after":{opacity:1,backgroundColor:t.itemActiveBg}},"&-label":Object.assign({minHeight:i,lineHeight:k(i),padding:`0 ${k(t.segmentedPaddingHorizontal)}`},jt),"&-icon + *":{marginInlineStart:t.calc(t.marginSM).div(2).equal()},"&-input":{position:"absolute",insetBlockStart:0,insetInlineStart:0,width:0,height:0,opacity:0,pointerEvents:"none"}},[`${e}-thumb`]:Object.assign(Object.assign({},he(t)),{position:"absolute",insetBlockStart:0,insetInlineStart:0,width:0,height:"100%",padding:`${k(t.paddingXXS)} 0`,borderRadius:t.borderRadiusSM,transition:`transform ${t.motionDurationSlow} ${t.motionEaseInOut}, height ${t.motionDurationSlow} ${t.motionEaseInOut}`,[`& ~ ${e}-item:not(${e}-item-selected):not(${e}-item-disabled)::after`]:{backgroundColor:"transparent"}}),[`&${e}-lg`]:{borderRadius:t.borderRadiusLG,[`${e}-item-label`]:{minHeight:a,lineHeight:k(a),padding:`0 ${k(t.segmentedPaddingHorizontal)}`,fontSize:t.fontSizeLG},[`${e}-item, ${e}-thumb`]:{borderRadius:t.borderRadius}},[`&${e}-sm`]:{borderRadius:t.borderRadiusSM,[`${e}-item-label`]:{minHeight:l,lineHeight:k(l),padding:`0 ${k(t.segmentedPaddingHorizontalSM)}`},[`${e}-item, ${e}-thumb`]:{borderRadius:t.borderRadiusXS}}}),ue(`&-disabled ${e}-item`,t)),ue(`${e}-item-disabled`,t)),{[`${e}-thumb-motion-appear-active`]:{transition:`transform ${t.motionDurationSlow} ${t.motionEaseInOut}, width ${t.motionDurationSlow} ${t.motionEaseInOut}`,willChange:"transform, width"},[`&${e}-shape-round`]:{borderRadius:9999,[`${e}-item, ${e}-thumb`]:{borderRadius:9999}}})}},St=t=>{const{colorTextLabel:e,colorText:i,colorFillSecondary:a,colorBgElevated:l,colorFill:o,lineWidthBold:d,colorBgLayout:u}=t;return{trackPadding:d,trackBg:u,itemColor:e,itemHoverColor:i,itemHoverBg:a,itemSelectedBg:l,itemActiveBg:o,itemSelectedColor:i}},wt=Le("Segmented",t=>{const{lineWidth:e,calc:i}=t,a=Be(t,{segmentedPaddingHorizontal:i(t.controlPaddingHorizontal).sub(e).equal(),segmentedPaddingHorizontalSM:i(t.controlPaddingHorizontalSM).sub(e).equal()});return[pt(a)]},St);var me=function(t,e){var i={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(i[a]=t[a]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,a=Object.getOwnPropertySymbols(t);l<a.length;l++)e.indexOf(a[l])<0&&Object.prototype.propertyIsEnumerable.call(t,a[l])&&(i[a[l]]=t[a[l]]);return i};function Ct(t){return typeof t=="object"&&!!(t!=null&&t.icon)}const It=s.forwardRef((t,e)=>{const i=Ge(),{prefixCls:a,className:l,rootClassName:o,block:d,options:u=[],size:m="middle",style:y,vertical:r,shape:c="default",name:x=i}=t,j=me(t,["prefixCls","className","rootClassName","block","options","size","style","vertical","shape","name"]),{getPrefixCls:_,direction:O,className:D,style:g}=Xe("segmented"),h=_("segmented",a),[v,R,C]=wt(h),S=Je(m),f=s.useMemo(()=>u.map(b=>{if(Ct(b)){const{icon:G,label:V}=b,X=me(b,["icon","label"]);return Object.assign(Object.assign({},X),{label:s.createElement(s.Fragment,null,s.createElement("span",{className:`${h}-item-icon`},G),V&&s.createElement("span",null,V))})}return b}),[u,h]),F=J(l,o,D,{[`${h}-block`]:d,[`${h}-sm`]:S==="small",[`${h}-lg`]:S==="large",[`${h}-vertical`]:r,[`${h}-shape-${c}`]:c==="round"},R,C),w=Object.assign(Object.assign({},g),y);return v(s.createElement(_t,Object.assign({},j,{name:x,className:F,style:w,options:f,ref:e,prefixCls:h,direction:O,vertical:r})))}),$t=It,Dt=s.forwardRef(({rowSelection:t,openModal:e,api:i,params:a,close:l,columns:o,hiddenSwitch:d=!1},u)=>{const[m,y]=s.useState(!0),{locale:r}=Ye(),[c]=s.useState(30),{data:x,pageNumber:j,totalPage:_,loading:O,reload:D,pageSize:g,setPageSize:h,setPageNumber:v,search:R}=at({url:i,initialPageSize:c,params:{...a,is_research:m,locale:r}});s.useImperativeHandle(u,()=>({reload:D,setPageNumber:v})),Ze();const{messageApi:C}=ve(),S=s.useMemo(()=>o({openModal:e,reload:D,messageApi:C}),[a==null?void 0:a.category]);return n.jsx("div",{children:n.jsx(it,{title:()=>n.jsxs(Y,{justify:"space-between",children:[n.jsxs(Y,{gap:"small",align:"center",children:[!d&&n.jsx(pe,{value:m,onChange:y,checkedChildren:"filter",unCheckedChildren:"all",size:"small",defaultChecked:!0}),n.jsx(U.Search,{size:"small",placeholder:"search...",allowClear:!0,enterButton:!0,onSearch:f=>{R(f)},style:{width:300}})]}),n.jsxs(Y,{gap:"small",children:[n.jsx(P,{title:"create",children:n.jsx(dt,{onClick:()=>{a!=null&&a.category?e("optModal",{entityType:"mesh",category:a==null?void 0:a.category}):e("optModal",{entityType:"mesh"})}})}),n.jsx(P,{title:"refresh",children:n.jsx(mt,{onClick:()=>D()})}),l&&n.jsx(Qe,{onClick:l})]})]}),rowSelection:t,rowKey:f=>f.entity_id,size:"small",bordered:!0,pagination:!1,loading:O,scroll:{x:"max-content"},columns:S,dataSource:x,footer:()=>n.jsx(n.Fragment,{children:_!=0&&n.jsxs(Y,{style:{marginTop:"1rem"},align:"center",gap:"small",children:[n.jsxs("p",{children:["A total of ",_," data "]}),n.jsx(st,{size:"small",current:j,pageSize:g,total:_,onChange:f=>v(f),showSizeChanger:!1}),n.jsx(H,{size:"small",value:g,onChange:h,options:[{key:10,value:10},{key:30,value:30},{key:50,value:50}]})]})})})})}),{Option:Xt}=H,Rt=({})=>{const[t,e]=s.useState("study"),[i,a]=s.useState("disease"),l=$.useFormInstance(),[o,d]=s.useState([]),[u,m]=s.useState([]),{modals:y,openModals:r,closeModals:c}=be(["entityDrawer"]),[x,j]=s.useState();return n.jsxs(n.Fragment,{children:[n.jsx($.Item,{label:"Study",name:"study_id",children:n.jsx(U,{placeholder:"which study or reference provides evidence",style:{cursor:"pointer"},onClick:()=>r("entityDrawer",{name:"study_id"})})}),n.jsx($.Item,{label:"Subject",name:"subject_id",children:n.jsx(U,{placeholder:"who does something",style:{cursor:"pointer"},onClick:()=>r("entityDrawer",{name:"subject_id"})})}),n.jsx($.Item,{label:"Object",name:"object_id",children:n.jsx(U,{placeholder:"who receives the effect",style:{cursor:"pointer"},onClick:()=>r("entityDrawer",{name:"object_id"})})}),n.jsx($.Item,{label:"Predicate",name:"predicate",children:n.jsx(H,{allowClear:!0,options:[{value:"CORRELATED_WITH",label:"CORRELATED_WITH"},{value:"PRODUCES",label:"PRODUCES"},{value:"MODULATES",label:"MODULATES"},{value:"ACTIVATES",label:"ACTIVATES"},{value:"INHIBITS",label:"INHIBITS"}]})}),n.jsx($.Item,{label:"effect",name:"effect",children:n.jsx(H,{allowClear:!0,options:[{value:"Up",label:"Up"},{value:"Down",label:"Down"}]})}),n.jsx($.Item,{label:"Observed",name:"observed_id",children:n.jsx(U,{placeholder:"where the phenomenon is observed (e.g., patient group, tissue, condition)",style:{cursor:"pointer"},onClick:()=>r("entityDrawer",{name:"observed_id"})})}),n.jsx(Ot,{form:l,setRecord:j,visible:y.entityDrawer.visible,params:y.entityDrawer.params,onClose:()=>c("entityDrawer")})]})},Ot=({visible:t,setRecord:e,form:i,params:a,onClose:l,callback:o})=>n.jsx(n.Fragment,{children:n.jsx(Se,{open:t,onClose:l,width:"80%",children:t&&n.jsx($e,{disableWidth:!0,rowSelection:{onChange:(d,u)=>{i.setFieldValue(a.name,u[0].entity_id),l()},type:"radio"}})})}),Mt=()=>n.jsxs(n.Fragment,{children:[n.jsx($.Item,{label:"entity_name_zh",name:"entity_name_zh",children:n.jsx(U,{})}),n.jsx($.Item,{label:"entity_type",name:"entity_type",rules:[{required:!0,message:"该字段不能为空!"}],children:n.jsx(H,{allowClear:!0,options:[{value:"Microbe",label:"Microbe"},{value:"Disease",label:"Disease"},{value:"Pathway",label:"Pathway"},{value:"Pathway",label:"Pathway"},{value:"Compound",label:"compound"},{value:"evidence",label:"Evidence"}]})}),n.jsx($.Item,{name:"tags",label:"tags",children:n.jsx(H,{mode:"tags",style:{width:"100%"}})}),n.jsx($.Item,{name:"short_name",label:"short_name",children:n.jsx(H,{mode:"tags",style:{width:"100%"}})})]}),we=({visible:t,params:e,onClose:i,record:a,callback:l,children:o,entityType:d="mesh"})=>{const[u]=$.useForm(),{messageApi:m}=ve(),[y,r]=s.useState(!1);s.useEffect(()=>{t&&(e!=null&&e.entityId)?c():u.resetFields()},[t]);const c=async()=>{r(!0);const j=await A.get(`/entity/get/${d}/${e.entityId}`);u.setFieldsValue(j.data),r(!1)},x=async()=>{const j=await u.validateFields();r(!0);try{e!=null&&e.entityId?await A.put(`/entity/update/${e.entityType}/${e.entityId}`,j):await A.post(`/entity/add/${e.entityType}`,j)}catch{r(!1),m.error("error!")}r(!1),i(),l&&l(),m.success("操作成功!")};return n.jsx(xe,{loading:y,title:e!=null&&e.entityId?"update entity":"create entity",onOk:x,width:"50%",open:t,onClose:i,onCancel:i,children:n.jsxs($,{form:u,children:[o,n.jsx(et,{ghost:!0,items:[{key:"1",label:"more",children:n.jsx(n.Fragment,{children:n.jsx($.Item,{noStyle:!0,shouldUpdate:!0,children:()=>n.jsx(tt,{children:n.jsx("pre",{children:JSON.stringify(u.getFieldsValue(),null,2)})})})})}]})]})})},Ft={mesh:Mt},Pt=({type:t,record:e})=>{const i=Ft[t]||(()=>n.jsxs("div",{children:["no ",t," component!"]}));return n.jsx(i,{record:e})},Et=({...t})=>{const{params:e,record:i}=t,[a,l]=s.useState([]);return s.useEffect(()=>{if(l([]),e!=null&&e.category&&Array.isArray(e==null?void 0:e.category)){const o=e==null?void 0:e.category.map(d=>({label:d,value:d}));l(o)}},[e]),n.jsx(n.Fragment,{children:n.jsxs(we,{...t,children:[!(e!=null&&e.entityId)&&n.jsx($.Item,{label:"category",name:"category",rules:[{required:!0,message:"该字段不能为空!"}],children:n.jsx(H,{options:a})}),n.jsx($.Item,{label:"is_research",name:"is_research",children:n.jsx(pe,{})}),n.jsx($.Item,{label:"entity_name",name:"entity_name",rules:[{required:!0,message:"该字段不能为空!"}],children:n.jsx(U,{})}),n.jsx(Pt,{type:e==null?void 0:e.entityType,record:i})]})})},Jt=({...t})=>n.jsx(n.Fragment,{children:n.jsx(we,{...t,entityType:"association",children:n.jsx(Rt,{})})}),Ce=(t,e,i)=>t.map(a=>a.key===e?{...a,children:i}:a.children?{...a,children:Ce(a.children,e,i)}:a),zt=s.forwardRef(({entityType:t,params:e},i)=>{const[a,l]=s.useState(),[o,d]=s.useState(new Set),[u,m]=s.useState(),[y,r]=s.useState("default"),c=async(h,v,R,C="")=>{const S=await A.post(`/entity/page/${t}`,{page_number:v,page_size:R,parent_id:String(h),keyword:C,...e}),{items:f,total:F}=S.data;if(t=="taxonomy"){const w=f.map(b=>({title:n.jsx(n.Fragment,{children:n.jsxs(P,{title:`${b.entity_name}(${b.rank})(${b.tax_id})`,children:[b.entity_name," (",b.rank,")"]})}),key:b.tax_id,isLeaf:!b.has_children}));return m(w),{children:w,total:F}}else if(t=="mesh"){const w=f.map(b=>({title:n.jsx(n.Fragment,{children:n.jsxs(P,{title:`${b.entity_name}`,children:[b.entity_name,"(",b.entity_id,")"]})}),key:b.tree_number,isLeaf:!b.has_children}));return m(w),{children:w,total:F}}else{const w=f.map(b=>({title:n.jsx(n.Fragment,{children:n.jsx(P,{title:`${b.entity_name}`,children:b.entity_name})}),key:b.entity_id,isLeaf:!b.has_children}));return m(w),{children:w,total:F}}},x=async()=>{const{children:h}=await c(y,1,-1);l(h)};s.useImperativeHandle(i,()=>({reload:x})),s.useEffect(()=>{x()},[t,JSON.stringify(e)]);const j=async({key:h,children:v})=>{if(v)return;d(C=>new Set(C).add(h));const{children:R}=await c(h,1,-1);l(C=>Ce(C,h,[...R])),d(C=>{const S=new Set(C);return S.delete(h),S})},_=s.useRef(null),[O,D]=s.useState(null),g=()=>{if(_.current){const h=_.current.getBoundingClientRect().top;D(window.innerHeight-h)}};return s.useEffect(()=>(g(),window.addEventListener("resize",g),()=>{window.removeEventListener("resize",g)}),[]),n.jsx("div",{ref:_,children:a?n.jsx(n.Fragment,{children:n.jsx(je,{height:O,loadData:j,treeData:a,showLine:!0,titleRender:h=>o.has(Number(h.key))?n.jsx(lt,{size:"small"}):h.title})}):n.jsx(_e,{active:!0})})}),Tt=t=>{let e=[];switch(t){case"organisms":e=[...e,{title:"entity_id",dataIndex:"entity_id",key:"taxonomy_id",render:(i,a)=>n.jsx("a",{href:`https://meshb.nlm.nih.gov/record/ui?ui=${i}`,target:"_blank",children:i})},{title:"entity_name",dataIndex:"entity_name",key:"entity_name",render:(i,a)=>n.jsx(n.Fragment,{children:a!=null&&a.entity_name_en?n.jsx(P,{title:a==null?void 0:a.entity_name_en,children:i}):n.jsx(n.Fragment,{children:i})})},{title:"taxonomy_name",dataIndex:"taxonomy_name",key:"taxonomy_name"},{title:"rank",dataIndex:"rank",key:"rank"},{title:"tax_id",dataIndex:"tax_id",key:"tax_id"},{title:"entity_type",dataIndex:"entity_type",key:"entity_type"},{title:"has_children",dataIndex:"has_children",key:"has_children",render:(i,a)=>i?"exist":"non-existent"},{title:"is_exist_graph",dataIndex:"is_exist_graph",key:"is_exist_graph",render:(i,a)=>i?"exist":"non-existent"}];break;case"mesh":e=[...e,{title:"entity_id",dataIndex:"entity_id",key:"taxonomy_id",render:(i,a)=>n.jsx("a",{href:`https://meshb.nlm.nih.gov/record/ui?ui=${i}`,target:"_blank",children:i})},{title:"entity_name",dataIndex:"entity_name",key:"entity_name",render:(i,a)=>n.jsx(n.Fragment,{children:a!=null&&a.entity_name_en?n.jsx(P,{title:a==null?void 0:a.entity_name_en,children:i}):n.jsx(n.Fragment,{children:i})})},{title:"short_name",dataIndex:"short_name",key:"short_name",render:(i,a)=>n.jsx(n.Fragment,{children:i&&Array.isArray(i)&&i.map((l,o)=>n.jsx(ce,{children:l},o))})},{title:"entity_type",dataIndex:"entity_type",key:"entity_type"},{title:"has_children",dataIndex:"has_children",key:"has_children",render:(i,a)=>i?"exist":"non-existent"},{title:"is_exist_graph",dataIndex:"is_exist_graph",key:"is_exist_graph",render:(i,a)=>i?"exist":"non-existent"},{title:"is_research",dataIndex:"is_research",key:"is_research",render:(i,a)=>i?"research":"non-research"},{title:"tags",dataIndex:"tags",key:"tags",render:(i,a)=>n.jsx(n.Fragment,{children:i&&Array.isArray(i)&&i.map((l,o)=>n.jsx(ce,{children:l},o))})}];break;case"association":e=[{title:"entity_id",dataIndex:"entity_id",key:"entity_id"},{title:"subject_name",dataIndex:"subject_name",key:"subject_name",render:(i,a)=>n.jsx(n.Fragment,{children:n.jsx(P,{title:a==null?void 0:a.subject_id,children:i})})},{title:"predicate",dataIndex:"predicate",key:"predicate"},{title:"object_name",dataIndex:"object_name",key:"object_name",render:(i,a)=>n.jsx(n.Fragment,{children:n.jsx(P,{title:a==null?void 0:a.object_id,children:i})})},{title:"effect",dataIndex:"effect",key:"effect"},{title:"study_name",dataIndex:"study_name",key:"study_name",render:(i,a)=>n.jsx(n.Fragment,{children:n.jsx(P,{title:a==null?void 0:a.study_id,children:i})})},{title:"observed_name",dataIndex:"observed_name",key:"observed_name",render:(i,a)=>n.jsx(n.Fragment,{children:n.jsx(P,{title:a==null?void 0:a.observed_id,children:i})})},{title:"created_at",dataIndex:"created_at",key:"created_at"}];break;default:e=[{title:"entity_id",dataIndex:"entity_id",key:"taxonomy_id"},{title:"entity_name",dataIndex:"entity_name",key:"entity_name"},{title:"has_children",dataIndex:"has_children",key:"has_children",render:(i,a)=>i?"exist":"non-existent"},{title:"is_exist_graph",dataIndex:"is_exist_graph",key:"is_exist_graph",render:(i,a)=>i?"exist":"non-existent"},{title:"is_research",dataIndex:"is_research",key:"is_research",render:(i,a)=>i?"research":"non-research"}]}return e},Nt=(t,e,i,a)=>{let l=[];switch(t){case"association":l=[{title:"操作",key:"action",fixed:"right",width:200,render:(o,d)=>n.jsx(oe,{size:"middle",children:e&&n.jsxs(n.Fragment,{children:[n.jsx(B,{size:"small",color:"cyan",variant:"solid",onClick:()=>{console.log("update:",d),e("optModal",{entityType:t,entityId:d.entity_id})},children:"update"}),n.jsx(ne,{title:"Confirm deletion?",onConfirm:async()=>{var u,m,y,r;try{await A.delete(`/entity-relation/delete-association/${d.entity_id}`),a.success("Delete successfully!"),i()}catch(c){console.log((m=(u=c==null?void 0:c.response)==null?void 0:u.data)==null?void 0:m.detail),a.error((r=(y=c==null?void 0:c.response)==null?void 0:y.data)==null?void 0:r.detail)}},children:n.jsx(B,{size:"small",danger:!0,variant:"solid",children:"delete"})})]})})}];break;case"mesh":l=[{title:"操作",key:"action",fixed:"right",width:200,render:(o,d)=>n.jsx(oe,{size:"middle",children:e&&n.jsxs(n.Fragment,{children:[n.jsx(B,{size:"small",color:"cyan",variant:"solid",onClick:()=>{e("entityDetailsModal",{entityType:t,entityId:d.entity_id})},children:"details"}),n.jsx(B,{size:"small",color:"cyan",variant:"solid",onClick:()=>{console.log("update:",d),e("optModal",{entityType:t,entityId:d.entity_id})},children:"update"}),d.is_exist_graph?n.jsxs(n.Fragment,{children:[n.jsx(B,{size:"small",color:"cyan",variant:"solid",onClick:()=>{e("graphView",{entityType:t,entityId:d.entity_id,entityName:d.entity_name})},children:"network"}),n.jsx(ne,{title:"确认删除节点?",onConfirm:async()=>{var u,m,y,r;try{await A.delete(`/entity/delete-node/${t}/${d.entity_id}`),a.success("删除成功!"),i()}catch(c){console.log((m=(u=c==null?void 0:c.response)==null?void 0:u.data)==null?void 0:m.detail),a.error((r=(y=c==null?void 0:c.response)==null?void 0:y.data)==null?void 0:r.detail)}},children:n.jsx(B,{size:"small",danger:!0,variant:"solid",children:"delete"})})]}):n.jsx(ne,{title:"Confirm deletion?",onConfirm:async()=>{var u,m,y,r;try{await A.delete(`/entity/delete/${t}/${d.entity_id}`),a.success("Delete successfully!"),i()}catch(c){console.log((m=(u=c==null?void 0:c.response)==null?void 0:u.data)==null?void 0:m.detail),a.error((r=(y=c==null?void 0:c.response)==null?void 0:y.data)==null?void 0:r.detail)}},children:n.jsx(B,{size:"small",danger:!0,variant:"solid",children:"delete"})})]})})}];break}return l},kt=s.lazy(()=>nt(()=>import("./graph-view-CFPtosdp.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]),import.meta.url)),Ie=s.forwardRef(({openModals:t,rowSelection:e,disableWidth:i=!1},a)=>{const[l,o]=s.useState("mesh"),[d,u]=s.useState({category:["F03","C10","F01"]}),[m,y]=s.useState("mental_disorders"),r=s.useRef(null),[c,x]=s.useState("table"),j=()=>{var g;(g=r.current)==null||g.reload()},_=g=>{var h;r.current&&((h=r.current)==null||h.setPageNumber(g))},O=[{key:"mental_disorders",label:"Mental Disorders"},{key:"organisms",label:"Microbe"},{key:"mesh-KEGG",label:"KEGG"},{key:"chemicals_and_drugs",label:"Chemicals and Drugs"},{key:"evidence",label:"Research Evidence"}],D=g=>{if(g.startsWith("mesh")){const h=g.split("-")[1];u({category:[h]}),o("mesh")}else g=="organisms"?(o("organisms"),u({category:["B02","B03","B04"],registry_join:"taxonomy"})):g=="mental_disorders"?(u({category:["F03","C10","F01"]}),o("mesh")):g=="chemicals_and_drugs"?(u({category:["D01","D02","D03","D04","D05","D06","D08","D09","D10","D12","D13","D20","D23","D25","D26","D27"]}),o("mesh")):g=="evidence"&&(u({category:["evidence"]}),o("mesh"))};return s.useImperativeHandle(a,()=>({reload:j})),n.jsxs("div",{style:i?{}:{maxWidth:"1500px",margin:"1rem auto"},children:[n.jsx("div",{style:{marginBottom:"1rem"},children:" "}),n.jsx(rt,{size:"small",activeKey:m,onChange:g=>{D(g),y(g),_(1)},tabBarExtraContent:n.jsx(n.Fragment,{children:n.jsx($t,{size:"small",value:c,onChange:g=>x(g),options:[{label:"table",value:"table"},{label:"tree",value:"tree"}]})}),items:O}),c=="table"&&n.jsx(n.Fragment,{children:n.jsx(Dt,{columns:({openModal:g,reload:h,messageApi:v})=>{const R=Tt(l),C=Nt("mesh",g,h,v);return[...R,...C]},rowSelection:e,ref:r,openModal:t,params:d,api:"/entity/page/mesh"})}),c=="tree"&&n.jsx(n.Fragment,{children:n.jsx(zt,{ref:r,entityType:"mesh",params:d})})]})}),$e=({...t})=>{const{modals:e,openModals:i,closeModals:a}=be(["entityPage","optModal","graphView","entityDrawer","entityDetailsModal"]),l=s.useRef(null),o=()=>{var d;(d=l.current)==null||d.reload()};return n.jsxs(n.Fragment,{children:[n.jsx(Ie,{...t,ref:l,openModals:i}),n.jsx(Et,{openModals:i,callback:o,visible:e.optModal.visible,params:e.optModal.params,onClose:()=>a("optModal")}),n.jsx(Ht,{callback:o,visible:e.graphView.visible,params:e.graphView.params,onClose:()=>a("graphView")}),n.jsx(At,{openModals:i,callback:o,visible:e.entityDetailsModal.visible,params:e.entityDetailsModal.params,onClose:()=>a("entityDetailsModal")})]})},Ht=({visible:t,params:e,onClose:i,callback:a})=>n.jsx(xe,{title:e==null?void 0:e.entityName,width:"60%",footer:null,open:t,onClose:i,onCancel:i,children:n.jsx(s.Suspense,{fallback:n.jsx(_e,{active:!0}),children:n.jsx(kt,{entity_id:e==null?void 0:e.entityId})})}),At=({visible:t,params:e,onClose:i})=>{const[a,l]=s.useState(!1),[o,d]=s.useState(),[u,m]=s.useState(),y=c=>c.map(x=>({title:x.entity_name,key:x.entity_id,children:x.children?y(x.children):[]})),r=async()=>{l(!0);const c=await A.get(`/entity/get/${e.entityType}/${e.entityId}`),x=y(c.data.parents);m(x),l(!1)};return s.useEffect(()=>{e!=null&&e.entityId&&r()},[e==null?void 0:e.entityId]),n.jsx(Se,{open:t,onClose:i,width:"40%",loading:a,children:u&&n.jsx(n.Fragment,{children:n.jsx(je,{treeData:u,defaultExpandAll:!0,showLine:!0,selectable:!0})})})},Yt=Object.freeze(Object.defineProperty({__proto__:null,EntityView:Ie,default:$e},Symbol.toStringTag,{value:"Module"}));export{Jt as A,Dt as D,dt as R,mt as a,Nt as b,Tt as g,Yt as i};
